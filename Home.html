
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <title>公用清冊</title>
    <!-- 管理端二欄式樣版樣式 -->
    <link href="https://webapp.nccu.edu.tw/CSS/style_new.css" rel="stylesheet" />
    <!-- jquery ui 主題為 flick 的樣式 -->
    <link href="https://webapp.nccu.edu.tw/CSS/themes/flick/jquery.ui.all.css" rel="stylesheet" />

    <!-- jquery -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery-1.9.1.min.js"></script> 
    <!-- jquery ui -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery-ui-1.10.2.min.js"></script> 

    <!-- 擴充 jquery 的事件支援 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.hook.js"></script>
    <!-- amplify 使 jquery 能使用像 observer pattern 般訂閱及取消註冊事件 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/amplify/amplify.min.js"></script>
    
    <!-- 跟 jquery 無關的共用 script，現階段有呼叫 ReportView 及處理表格欄位太長等相關函式 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/Shared/Common.js"></script>
    <!-- 跟 jquery 有關的共用 script，基本共用函式例如遮罩設定及共用的 ajax 處理函式 -->
    
    <script type="text/javascript" src="/GE/GE06/GE0601/Scripts/Shared/jQuery/Common-ann.js"></script>

    <!-- jquery 對 validate 的函式 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.validate.min.js"></script>
    <!-- jquery validate 官方對 jquery validate 的擴充 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/additional-methods.min.js"></script>
    <!-- 微軟 MVC3 支援 jquery validate 的擴充，通常使用在表單載入完成時，所以跟表單的 PartialView 放在一起 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.validate.unobtrusive.min.js"></script>
    <!-- 擴充支援的表單驗証，例如起迄日期及起迄數字的驗証...等等 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.validate.unobtrusive.extension.js"></script>

    <!-- 微軟 MVC3 使用 ajaxoptions 來支援 jquery ajax 的擴充函式 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.unobtrusive-ajax.js"></script>
    <!-- jquery 的遮罩 Mask 的支援函式 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.blockUI.js"></script>
    <!-- 擴充在 MVC 專案中使用顯示錯誤訊息及時間欄位驗証的函式 -->
    <script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.mvc.js"></script>
    
    <!-- 一些客製化過的共用 CSS -->
    <link href="/GE/GE06/GE0601/Content/Common.css" rel="stylesheet" />
    
    <style type="text/css">
        #ui-datepicker-div { display:none}
        .iput_btn
        {
            cursor: pointer;
        }
        .iput_btn_disabled {
	        height: 2.25em;
	        width: 9em;
	        background-image: url(https://webapp.nccu.edu.tw/GE/GE06/GE0601/content/images/btn.gif);
	        font-weight: bold;
	        color: #999999;
	        font-size: 1em;
	        float: left;
	        margin-right: 10px;
	        min-width: 9em;
	        border: 1px solid #b4b4b4;
	        margin-top: 5px;
	        float: none;
        }
        
        .newdialog {
            overflow: visible;
            overflow-y:auto;
        }
        
        .ui-datatable-scrollable-header table { table-layout: fixed; }
        
        .ui-datatable-scrollable table td, .ui-datatable-scrollable table th { overflow-x: auto; }
        
    </style>    
    
</head>
<body id="p01">
    <div id="dialog_box" style="color:Red;"><div class="validation-summary excluded" style="font-weight: bold;"><ul><li><div class="validation-summary-errors"><ul><li style="display:none"></li>
</ul></div></li></ul></div></div>
    <div class="content_block_subsystem">
        <div class="subsystem_title">
            
公用清冊

            <div id="word_btn_area"><div class="word_btn"> <a href="javascript: void(0);" class="condense">小字</a></div><div class="word_btn"> <a href="javascript: void(0);" class="magnify">大字</a></div></div>
        </div>
        <div class="subsystem_content_box_1_clmn">
            <div id="container" class="subsystem_content_area_1_clm">
                
<script type="text/javascript" src="/GE/GE06/GE0601/Scripts/Shared/jQuery/jquery.unobtrusive-ajax.crud.js"></script>
<!-- 檢查輸入!!! -->
<script type="text/javascript" src="/GE/GE06/GE0601/Scripts/jQuery/jquery.numeric.js"></script>
<!-- 使用 FixedTable 必須要引入下列2個檔案!!! -->
<script type="text/javascript" src="/GE/GE06/GE0601/Scripts/Shared/jQuery/jquery.dataTables.js"></script>
<script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/FixedColumns-2.0.3/FixedColumns.js"></script>
<!-- 轉貨幣符號!!! -->
<script type="text/javascript" src="/GE/GE06/GE0601/Scripts/jQuery/jquery.number.min.js"></script>
<input id="msg" name="msg" style="display:none;" type="text" value="" />
<span id="msg2" style="color: red"></span>
<div id="SearchForm">
    <div class="item_position">
        ‧進行以下作業：</div>
    <div onclick="location.href='/GE/GE06/GE0601/Home/Create'" class="btn_normal_1">
        <a href="/GE/GE06/GE0601/Home/Create">新增</a>
    </div>
    <div onclick="$('#SearchForm').hide();$('#PrintDialog').show();ClearMsg();InitPPaylstNum();"
        class="btn_normal_1">
        <a href="javascript: void(0);">列印</a>
    </div>
    <div onclick="$('#SearchForm').hide();$('#CopyDialog').show();ClearMsg();InitCPaylstNum();"
        class="btn_normal_1">
        <a href="javascript: void(0);">複製</a>
    </div>
    <br />
    <br />
    <br />
    <br />
    <br />
    <div class="h_line">
    </div>
    <div class="item_position">
        ‧搜尋項目：請輸入搜尋條件<div style="color: Red; display: inline;">
            (只允許查詢本人所造之清冊資料)</div>
    </div>
    <script src="/GE/GE06/GE0601/Scripts/jQuery/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>
<script type="text/javascript" src="https://webapp.nccu.edu.tw/CSS/Scripts/jQuery/jquery.validate.unobtrusive.extension.js"></script>
<form action="/GE/GE06/GE0601/Home/Search" data-ajax="true" data-ajax-begin="window.searchOpts.begin" data-ajax-failure="window.searchOpts.failure" data-ajax-success="window.searchOpts.success" id="simsearch_638499940937729349" method="post" onsubmit="window.$form = $(this);" style="display: inline;">    <div class="content_table_06">
        <table width="100%" cellspacing="0" cellpadding="5" border="0">
            <tbody>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        起迄清冊號
                    </td>
                    <td class="content_table_04_content">
                        <input class="positive-integer" data-val="true" data-val-regex="起始清冊號格式錯誤" data-val-regex-pattern="[0-9]*" id="st_paynum" maxlength="7" name="st_paynum" type="text" value="" />
                        <label for="">～</label>
                        <input class="positive-integer" data-val="true" data-val-biggerthan="終止清冊號不能小於起始清冊號" data-val-biggerthan-other="st_paynum" data-val-regex="終止清冊號格式錯誤" data-val-regex-pattern="[0-9]*" id="ed_paynum" maxlength="7" name="ed_paynum" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="st_paynum" data-valmsg-replace="true"></span>
                        <span class="field-validation-valid" data-valmsg-for="ed_paynum" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        造冊起迄日
                    </td>
                    <td class="content_table_04_content">
                        <input Value="2024/01/01" data-val="true" data-val-regex="造冊起始日格式錯誤(格式：yyyy/mm/dd)" data-val-regex-pattern="^[0-9]{4}/(((0[13578]|(10|12))/(0[1-9]|[1-2][0-9]|3[0-1]))|(02/(0[1-9]|[1-2][0-9]))|((0[469]|11)/(0[1-9]|[1-2][0-9]|30)))$" id="st_paydt" name="st_paydt" type="text" value="" />
                        <label for="">～</label>
                        <input data-val="true" data-val-greaterthan="結束日期不能小於開始日期" data-val-greaterthan-other="st_paydt" data-val-regex="造冊終止日格式錯誤(格式：yyyy/mm/dd)" data-val-regex-pattern="^[0-9]{4}/(((0[13578]|(10|12))/(0[1-9]|[1-2][0-9]|3[0-1]))|(02/(0[1-9]|[1-2][0-9]))|((0[469]|11)/(0[1-9]|[1-2][0-9]|30)))$" id="ed_paydt" name="ed_paydt" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="st_paydt" data-valmsg-replace="true"></span>
                        <span class="field-validation-valid" data-valmsg-for="ed_paydt" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        轉帳起迄日
                    </td>
                    <td class="content_table_04_content">
                        <input data-val="true" data-val-regex="轉帳起始日格式錯誤(格式：yyyy/mm/dd)" data-val-regex-pattern="^(19|20)\d\d/(((0[13578]|(10|12))/(0[1-9]|[1-2][0-9]|3[0-1]))|(02/(0[1-9]|[1-2][0-9]))|((0[469]|11)/(0[1-9]|[1-2][0-9]|30)))$" id="st_trandt" name="st_trandt" type="text" value="" />
                        <label for="">～</label>
                        <input data-val="true" data-val-greaterthan="結束日期不能小於開始日期" data-val-greaterthan-other="st_trandt" data-val-regex="轉帳終止日格式錯誤(格式：yyyy/mm/dd)" data-val-regex-pattern="^(19|20)\d\d/(((0[13578]|(10|12))/(0[1-9]|[1-2][0-9]|3[0-1]))|(02/(0[1-9]|[1-2][0-9]))|((0[469]|11)/(0[1-9]|[1-2][0-9]|30)))$" id="ed_trandt" name="ed_trandt" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="st_trandt" data-valmsg-replace="true"></span>
                        <span class="field-validation-valid" data-valmsg-for="ed_trandt" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        清冊狀態
                    </td>
                    <td class="content_table_04_content">
                        <input class="" id="ProcSts" name="ProcSts" style="width:200px;display:none;" type="text" value="" />
                        <select class="" id="ProStsDDL" name="ProStsDDL"><option selected="selected" value="">請選擇</option>
<option value="O">暫存</option>
<option value="C">確認</option>
<option value="D">作廢</option>
<option value="Z">結報</option>
</select>
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        關鍵字查詢
                    </td>
                    <td class="content_table_04_content">
                        <input id="Title2" name="Title2" type="text" value="" />
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <input type="submit" class="iput_btn" value="搜尋" onclick="window.$form = $('form#simsearch_638499940937729349');" />
    <input class="ResetBtn" type="reset" value="清除" style="display: none" />
    <script type="text/javascript">
        // 清冊狀態
        $('#ProStsDDL').change(function () {
            $('#ProcSts').val($("#ProStsDDL option:selected").val());
        });
    </script>
</form>
    <div class="clear">
    </div>
</div>
<div id="PrintDialog" style="display: none;" class="wizard">
    <div class="item_position">
        ‧進行以下作業：</div>
<form action="/GE/GE06/GE0601/Home/Report" method="post" target="_blank">        <table width="50%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        清冊號
                    </td>
                    <td class="content_table_04_content">
                        <input class="textfield_must" data-val="true" data-val-length="欄位 清冊號 必須是最大長度為 7 的字串。" data-val-length-max="7" data-val-required="清冊號 欄位是必要項。" id="dfPyNum" name="PaylstNum" style="width:200px;display:none;" type="text" value="" />
                        <select class="textfield_must" id="dfPyNumDDL" name="PyDDL"><option selected="selected" value="">請選擇</option>
</select>
                        <div id="pmsg" style="color: Red; display: inline;">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        報表格式
                    </td>
                    <td class="content_table_04_content"><input checked="checked" id="rb" name="rb" type="radio" value="1" />簡式 <input id="rb" name="rb" type="radio" value="2" />薪資
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        一級主管
                    </td>
                    <td class="content_table_04_content"><input id="dfChief1" name="dfChief1" style="width:200px" type="text" value="單位主管" />
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        組長(主任)/計畫主持人
                    </td>
                    <td class="content_table_04_content"><input id="dfChief2" name="dfChief2" style="width:200px" type="text" value="組長(主任)/計畫主持人" />
                    </td>
                </tr>
                <tr>
                    <td style="width: 160px;" class="content_table_04_title">
                        會簽單位
                    </td>
                    <td class="content_table_04_content"><input id="dfProcUtCod" name="dfProcUtCod" style="width:200px" type="text" value="" />
                    </td>
                </tr>
            </tbody>
        </table>
注意：下列案件請選擇正確的會簽單位，有會簽單位者，請先送會簽單位再送主計室。        <ol>
            <li>校外委託/補助之科技部及非科技部計畫主持人費，請會簽研發處。</li>
            <li>校外委託/補助之科技部及非科技部計畫勞動型臨時性人員薪資且涉及保費，請依序會簽研發處、人事室。</li>
            <li>有辦理進用(有員工代號)之專兼任助理的薪資或學習津貼，請會簽人事室。</li>
            <li>涉及勞保費、健保費者，請會簽人事室。(惟如僅涉及補充保費免會人事室)</li>
            <li>涉及試務工作酬勞者，請會簽人事室。</li>
            <li>其他報支仍請視實際需要會簽相關單位。</li>
        </ol>
        <div style="padding-top: 5px">
            <input id="ReportBtn" class="iput_btn" type="button" value="產生報表" />
            <input id="PrintReportBtn" class="iput_btn" type="submit" style="display:none" onclick="window.$form = $('form#simsearch_638499940937729349');" />
            <input class="ResetBtn" type="reset" value="清除" style="display: none" />
            <input class="iput_btn" type="button" value="回上一頁" onclick="$('#SearchForm').show();$('#PrintDialog').hide();$('.ResetBtn').click();$('#pmsg').text('');" />
        </div>
</form></div>
<div id="CopyDialog" style="display: none;" class="wizard">
    <div class="item_position">
        ‧進行以下作業：</div>
    <table width="50%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
        class="content_table_06">
        <tbody>
            <tr>
                <td style="width: 160px;" class="content_table_04_title">
                    清冊號
                </td>
                <td class="content_table_04_content">
                    <input class="textfield_must" id="dfCpNum" name="PaylstNum" style="width:200px;display:none;" type="text" value="" />
                    <select class="textfield_must" id="dfCpNumDDL" name="PyDDL"><option selected="selected" value="">請選擇</option>
</select>
                    <div id="cmsg" style="color: Red; display: inline;">
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <div style="padding-top: 5px">
        <input id="CopyNewBtn" class="iput_btn" type="submit" value="新增" />
        <input class="iput_btn" type="button" value="回上一頁" onclick="$('#SearchForm').show();$('#CopyDialog,#CopyMode').hide();$('#cpcontext').html('');$('#dfCpNum').val('');$('#cmsg').text('');" />
    </div>
    <div id="CopyMode" style="display: none;">
        <table width="50%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <thead>
                <tr>
                    <th class="content_table_06_title" style="width: 100px;">
                        清冊號
                    </th>
                    <th class="content_table_06_title" style="width: 200px;">
                        案由
                    </th>
                    <th class="content_table_06_title" style="width: 40px;">
                        處理
                    </th>
                </tr>
            </thead>
            <tbody id="cpcontext">
            </tbody>
        </table>
        <table width="50%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 9.5%;" class="content_table_04_title">
                        <label for="WorkYM">支領年月</label>
                    </td>
                    <td class="content_table_04_content">
                        <label for="">民國</label>
                        <select class="textfield_must" id="WorkYYDDLCOPY" name="WorkYYDDLCOPY" onchange=""><option value="2025">114</option>
<option selected="selected" value="2024">113</option>
<option value="2023">112</option>
</select>
                        <label for="">年</label>
                        <select class="textfield_must" id="WorkMMDDLCOPY" name="WorkMMDDLCOPY" onchange=""><option value="01">1</option>
<option value="02">2</option>
<option value="03">3</option>
<option selected="selected" value="04">4</option>
<option value="05">5</option>
<option value="06">6</option>
<option value="07">7</option>
<option value="08">8</option>
<option value="09">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
</select>
                        <label for="">月</label>
                        <br />
                        應支領該款項之年度月份,不同月份請依月份個別輸入
                        <input Value="202404" id="WorkYMCOPY" maxlength="6" name="WorkYM" style="visibility:hidden;" type="text" value="" />
                        
                    </td>
                </tr>
            </tbody>
        </table>
        <div style="padding-top: 5px">
            <input id="CopyBtn" class="iput_btn" type="button" value="開始複製" />
        </div>
    </div>
</div>
<div id="EditMode" style="display: block;" class="wizard">
<div id="fixedTable_1347406504" class="fixedTable" style="float: left; width: 100%">        <div id="result_listE" class="result_listE" style="float: left; width: 100%;">
            <div class="item_position">‧主檔內容：</div>
<table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;" class="content_table_06">
    <tbody>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">清冊號</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">流通文號</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">造冊日</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">轉帳日</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">抬頭</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
            <td style="width: 50px;" class="content_table_03_title">案由</td>
            <td class="content_table_04_content">
                <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>
            </td>
        </tr>
        <tr>
        <td style="width: 50px;" class="content_table_03_title">計畫名稱</td>
                <td class="content_table_04_content">
                 <span style="color: rgb(169, 25, 42); font-weight: bold; font-size: 1em;">
                </span>             
    </td></tr>
    </tbody>
</table>
<br />
<div class="item_position">
    ．修改項目：<div id="updateMsg" style="color:Red;display:inline;"></div>
</div>

<div class="content_table_06" style="background-color: #d5efff; overflow-x:visible;">
    <table id="fixedTableEdit" cellspacing="0" cellpadding="1" border="0" width="100%" style="table-layout:fixed;">
        <thead>
            <tr>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:15px; overflow: hidden; text-overflow: ellipsis; max-width: 15px; min-width:15px">
                    人<br />
                    員
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:15px; overflow: hidden; text-overflow: ellipsis; max-width: 15px; min-width:15px">
                    帳<br />
                    別
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:45px; overflow: hidden; text-overflow: ellipsis; max-width: 45px; min-width:45px">
                    代&nbsp;&nbsp;號
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:45px; overflow: hidden; text-overflow: ellipsis; max-width: 45px; min-width:45px">
                    受款人
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:15px; overflow: hidden; text-overflow: ellipsis; max-width: 15px; min-width:15px">
                    年
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:15px; overflow: hidden; text-overflow: ellipsis; max-width: 15px; min-width:15px">
                    月
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:75px; overflow: hidden; text-overflow: ellipsis; max-width: 75px; min-width:75px">
                    款&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;項
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:55px; overflow: hidden; text-overflow: ellipsis; max-width: 55px; min-width:55px">
                    單&nbsp;價
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:30px; overflow: hidden; text-overflow: ellipsis; max-width: 30px; min-width:30px">
                    數<br />
                    量
                </th>
                <th class="content_table_06_title" style="white-space: nowrap; height: 25px; width:65px; overflow: hidden; text-overflow: ellipsis; max-width: 65px; min-width:65px">
                    金&nbsp;額
                </th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">所得稅</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">公勞<br />自付</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">勞保<br />雇主</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">健保<br />自付</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">健保<br />雇主</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">健補<br />自付</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">健補<br />雇主</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">退撫<br />勞退</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">勞退<br />雇主</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">請假<br />扣薪</th>
                <th class="content_table_06_title" style="height:25px; width:65px; max-width: 65px; min-width:65px">其他<br />扣款</th>
                <th class="content_table_06_title" style="height:25px;width:200px;min-width:200px;max-width: 200px;">備註</th>
                <th class="content_table_06_title" style="height:25px;width:350px;min-width:350px;max-width: 380px;">備註2</th>
                <th class="content_table_06_title" style="white-space: nowrap; height:25px;width:50px; overflow: hidden; text-overflow: ellipsis; max-width: 50px; min-width:50px">實發</th>
                <th class="content_table_06_title" style="white-space: nowrap; height:25px;width:40px; overflow: hidden; text-overflow: ellipsis; max-width: 40px; min-width:40px">處理</th>
            </tr>
        </thead>
        <tbody>
            <tr class="content_table_06_content_bg_0 totalTR" style=" height: 0px !important;" key="abc">
                <td class="content_table_06_content" style="white-space: nowrap; width: 15px; height: 25px; max-width: 15px; min-width:15px">合</td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 15px; height: 25px; max-width: 15px; min-width:15px">計</td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 45px; height: 25px; max-width: 45px; min-width:45px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 45px; height: 25px; max-width: 45px; min-width:45px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 15px; height: 25px; max-width: 15px; min-width:15px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 15px; height: 25px; max-width: 15px; min-width:15px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 75px; height: 25px; max-width: 75px; min-width:75px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 55px; height: 25px; max-width: 55px; min-width:55px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 20px; height: 25px; max-width: 20px; min-width:20px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; width: 65px; height: 25px; max-width: 65px; min-width:65px; text-align: right"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px; max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="text-align: right; height: 25px; width:65px;max-width: 65px; min-width:65px;"></td>
                <td class="content_table_06_content" style="width:200px; height: 25px; text-align: left; max-width: 200px; min-width:200px"></td>
                <td class="content_table_06_content" style="width:350px; height: 25px; text-align: left; max-width: 380px; min-width:350px"></td>
                <td class="content_table_06_content" style="white-space: nowrap; height:25px;width:50px; overflow: hidden; text-overflow: ellipsis; max-width: 50px; min-width:50px; text-align: right"></td>
                <td class="content_table_06_content" style="white-space: nowrap; height:25px;width:40px; overflow: hidden; text-overflow: ellipsis; max-width: 40px; min-width:40px"></td>
            </tr>
        </tbody>
    </table>
</div>

<div style="padding-top: 5px">
<form action="/GE/GE06/GE0601/Home/GoBack" data-ajax="true" data-ajax-begin="window.searchOpts.begin" data-ajax-failure="window.searchOpts.failure" data-ajax-success="window.searchOpts.success" id="append_PartialFixedTableE638499940937885592" method="post" style="display: inline;"> <input class="iput_btn" type="submit" value="回上一頁" onclick="$('#Search_Result').show();$('#EditMode').hide();" /> </form></div>

<script type="text/javascript">
//<![CDATA[
    $(function () {
        $("#dialog:ui-dialog").dialog("destroy");
        window.dialogSize = 900;        
        $("#SimpleNewDialog2").dialog({
            autoOpen: false,
            width: window.dialogSize ? window.dialogSize : 900, 
            resizable: false,
            modal: true,
            closeOnEscape: false,
            open: function (event, ui) {
                $this = $(this);
                $this.parent().removeClass('ui-widget').removeClass('ui-widget-content').addClass('ui-dialog').addClass('newdialog').addClass('pop_detail_box').children().first().removeAttr('Class').addClass('pop_detail_title').next().removeClass('ui-widget-content').addClass('detail_box_content');
            },
            close: function () {
                $('.field-validation-valid,.field-validation-error').empty();
            }
        });
        $("#SalaryNewDialog2").dialog({
            autoOpen: false,
            width: window.dialogSize ? window.dialogSize : 900, 
            resizable: false,
            modal: true,
            closeOnEscape: false,
            open: function (event, ui) {
                $this = $(this);
                // Custormizing CSS...
                $this.parent().removeClass('ui-widget').removeClass('ui-widget-content').addClass('ui-dialog').addClass('newdialog').addClass('pop_detail_box').children().first().removeAttr('Class').addClass('pop_detail_title').next().removeClass('ui-widget-content').addClass('detail_box_content');
            },
            close: function () {
                $('.field-validation-valid,.field-validation-error').empty();
            }
        });
        $(".positive-integer").numeric({ decimal: false, negative: false },
        function () {
            var container = $("[data-valmsg-for='" + $(this).attr('name') + "']");
            container.removeClass("field-validation-valid").addClass("field-validation-error");
            container.html("欄位值必須是數字");
            $(this).val('');
            $(this).focus();
        });
    });
    /* FixedTable 新增資料 */
    function addRowE(data, c) {
        //debugger;
        // 隱藏空白的第一筆(在清冊無明細時)
        $(".emptr").hide();
        
        // 先刪合計再重新加上去
        deleteRow_FixedTableCal();

        var oTable = eval('window.' + $('.result_listE').parent().attr('id'));
        // 利用堆疊觀念，取出放在最後一欄的主鍵。 
        var pk = data.pop();
        var added_aoData = oTable.fnAddData(data)[0];
        var $row = $(oTable.fnSettings().aoData[added_aoData].nTr);
        $row.addClass('content_table_06_content_bg_0').css('background', 'red').attr('key', pk);
        $row.children().addClass('content_table_06_content').css("height", "25px").css("text-align", "right");
        //$row.children().eq(11).css("text-align", "left");
        //$row.children().eq(21).css("text-align", "left");
        $row.children().eq(13).css("text-align", "left");
        $row.children().eq(0).css("text-align", "center");
        var $hidTds = window.ggyymo = $(oTable.fnSettings().aoData[added_aoData]._anHidden);
        $.each($hidTds, function (idx, el) {
            debugger;
            if (el != null) {
                $(el).addClass('content_table_06_content').css("white-space", "nowrap").css("height", "25px").css("overflow", "hidden").css("text-overflow", "ellipsis");
                switch (idx) {
                    case 0:
                    case 1:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px");
                        break;
                    case 2:
                        $(el).css("width", "45px").css("max-width", "45px").css("min-width", "45px").css("text-align", "left");
                        break;
                    case 3:
                        $(el).css("width", "45px").css("max-width", "45px").css("min-width", "45px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 4:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 5:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 6:
                        $(el).css("width", "75px").css("max-width", "75px").css("min-width", "75px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 7:
                        $(el).css("width", "55px").css("max-width", "55px").css("min-width", "55px").css("text-align", "right");
                        break;
                    case 8:
                        $(el).css("width", "30px").css("max-width", "30px").css("min-width", "30px");
                        break;
                    case 9:
                        $(el).css("width", "65px").css("max-width", "65px").css("min-width", "65px").css("text-align", "right");
                        break;
                    case 10:
                    case 11:
                    case 12:
                    case 13:
                    case 14:
                    case 15:
                    case 16:
                    case 17:
                    case 18:
                    case 19:
                    case 20:
                        $(el).css("width", "65px").css("max-width", "65px").css("min-width", "65px").css("text-align", "right");
                        break;
                    case 21:
                        $(el).css("width", "200px").css("max-width", "200px").css("min-width", "200px").css("text-align", "left");
                        break;
                    case 22:
                        $(el).css("width", "350px").css("max-width", "380px").css("min-width", "350px").css("text-align", "left");
                        break;
                    case 23:
                        $(el).css("width", "50px").css("max-width", "50px").css("min-width", "50px").css("text-align", "right");
                        break;
                    case 24:
                        $(el).css("width", "40px").css("max-width", "40px").css("min-width", "40px");
                        break;
                }
            }
        });
        // 合計
        Calculator();
        // 如果畫面上有使用到 fixedtable 元件，去觸發執行相對應的事件。
        amplify.publish("triggerFixedTable");

        $('.field-validation-error').empty();
        if (c == 1) $("#StaNumE").setfocus(); else $("#StaNumF").setfocus();
        ClearSome();
    };
    /* FixedTable 新增資料 */
    function addRowCal(data) {
        debugger;
        var oTable = eval('window.' + $('.result_listE').parent().attr('id'));
        // 利用堆疊觀念，取出放在最後一欄的主鍵。
        var pk = data.pop();
        var added_aoData = oTable.fnAddData(data)[0];
        var $row = $(oTable.fnSettings().aoData[added_aoData].nTr);
        $row.addClass('content_table_06_content_bg_0 totalTR').attr('key', pk);
        $row.children().addClass('content_table_06_content').css("height", "25px").css("text-align", "right");
        $row.children().eq(13).css("text-align", "left");
        $row.children().eq(0).css("text-align", "center");
        var $hidTds = window.ggyymo = $(oTable.fnSettings().aoData[added_aoData]._anHidden);
        $.each($hidTds, function (idx, el) {
            if (el != null) {
                $(el).addClass('content_table_06_content').css("white-space", "nowrap").css("height", "25px").css("overflow", "hidden").css("text-overflow", "ellipsis");
                switch (idx) {
                    case 0:
                    case 1:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px");
                        break;
                    case 2:
                        $(el).css("width", "45px").css("max-width", "45px").css("min-width", "45px").css("text-align", "left");
                        break;
                    case 3:
                        $(el).css("width", "45px").css("max-width", "45px").css("min-width", "45px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 4:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 5:
                        $(el).css("width", "15px").css("max-width", "15px").css("min-width", "15px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 6:
                        $(el).css("width", "75px").css("max-width", "75px").css("min-width", "75px").css("text-overflow", "clip").css("text-align", "left");
                        break;
                    case 7:
                        $(el).css("width", "55px").css("max-width", "55px").css("min-width", "55px").css("text-align", "right");
                        break;
                    case 8:
                        $(el).css("width", "30px").css("max-width", "30px").css("min-width", "30px");
                        break;
                    case 9:
                        $(el).css("width", "65px").css("max-width", "65px").css("min-width", "65px").css("text-align", "right"); ;
                        break;
                    case 10:
                    case 11:
                    case 12:
                    case 13:
                    case 14:
                    case 15:
                    case 16:
                    case 17:
                    case 18:
                    case 19:
                    case 20:
                        $(el).css("width", "65px").css("max-width", "65px").css("min-width", "65px").css("text-align", "right");
                        break;
                    case 21:
                        $(el).css("width", "200px").css("max-width", "200px").css("min-width", "200px").css("text-align", "left");
                        break;
                    case 22:
                        $(el).css("width", "350px").css("max-width", "380px").css("min-width", "350px").css("text-align", "left");
                        break;
                    case 23:
                        $(el).css("width", "50px").css("max-width", "50px").css("min-width", "50px").css("text-align", "right");
                        break;
                    case 24:
                        $(el).css("width", "40px").css("max-width", "40px").css("min-width", "40px");
                        break;
                }
            }
        });
        
        // 如果畫面上有使用到 fixedtable 元件，去觸發執行相對應的事件。
        amplify.publish("triggerFixedTable");
    };
    /* FixedTable 刪除資料 */
    function deleteRow_FixedTable(target) {
        var cfm = window.confirm('確定要刪除[' + $(target).attr('keydes') + ']此筆資料?');
        if (cfm) { /*$('tr[key=' + $(this).attr('key') + ']').remove();*/
            var oTable = eval('window.' + $('.result_listE').parent().attr('id'));
            //call deldetail, no return value, warnning...
            DelDetail($(target).attr('key'));
            oTable.fnDeleteRow($(oTable.fnGetNodes()).filter('tr[key=' + $(target).attr('key') + ']')[0]);
            
        }
    }
    /* FixedTable 刪除合計 */
    function deleteRow_FixedTableCal() {
        var oTable = eval('window.' + $('.result_listE').parent().attr('id'));
        //call deldetail, no return value, warnning...
        oTable.fnDeleteRow($(oTable.fnGetNodes()).filter('tr[key=abc]')[0]);
    }
//]]>
</script>
        </div>
<!-- 因為表格欄位太長或資料太多，固定資料列表的表頭及欄位。 -->
<script language='javascript'>
//<![CDATA[
$().ready(function() {

   /* 註冊在送出搜尋後成功取代畫面後的事件 */
   function showFixedTable_(data) {
       if (window.PauseFixedTable) {
           window.PauseFixedTable = null;
           return;
       }

       if (typeof data != 'boolean') {
           var pnl = (window.$form && window.$form.attr('data-ajax-update-bak') != null) ? window.$form.attr('data-ajax-update-bak') : '.result_list'
           if ($(pnl + ' #fixedTable_1347406504, #fixedTable_1347406504 ' + pnl).length == 0) return;
       }

       window.fixedTable_1347406504 = $('div#fixedTable_1347406504 table#fixedTableEdit').dataTable({
           "sScrollY": "400px",
           "sScrollX": "100%",
           "sScrollXInner": "260%",
           "bScrollCollapse": true,
           "bPaginate": false,
           "bSort": false,
           "bFilter": false,
           "bInfo": false,
           "bAutoWidth": true,
           "bServerSide": false
       });
       window.fixedTable_1347406504.fixedColumns = new FixedColumns(fixedTable_1347406504, {
           "iLeftColumns": 8,
           "iRightColumns": 2,
           "sHeightMatch": "none",
           "sLeftWidth": "relative",
           "iLeftWidth": 40,
           "fnDrawCallback": function(arg1, arg2) { }
       });
       if (window.fixedTable_1347406504.fixedColumns) window.fixedTable_1347406504.fnAdjustColumnSizing();
   }
   function resizeFixedTable_() {
       if (!window.fixedTable_1347406504.resizedDT) window.fixedTable_1347406504.resizedDT = new Date(); 
       else { var now = new Date(); var diff = Math.round((now - window.fixedTable_1347406504.resizedDT) / 1000); window.fixedTable_1347406504.resizedDT = now; if (diff < 2) return; }
       if (window.fixedTable_1347406504.fixedColumns) { window.fixedTable_1347406504.fixedColumns.fnRedrawLayout(); }
       try { window.fixedTable_1347406504.fnAdjustColumnSizing(); } catch(e) {}
   }
   function resizeFixedTableColumns_() {
       if (window.fixedTable_1347406504.fixedColumns) { window.fixedTable_1347406504.fixedColumns.fnRedrawLayout(); }
       try { window.fixedTable_1347406504.fnAdjustColumnSizing(); } catch(e) {}
   }
   showFixedTable_(true);
   amplify.subscribe('doAfterReplace', showFixedTable_);
   amplify.subscribe('triggerFixedTable', resizeFixedTableColumns_);

   $(window).resize(resizeFixedTable_);
});

//]]>
</script>
</div></div>
<div id="SimpleNewDialog2" style="display: none;">
<form action="/GE/GE06/GE0601/Home/FNew" data-ajax="true" data-ajax-begin="window.fake.beginfake" data-ajax-complete="window.fake.complete" data-ajax-failure="window.fake.failure" data-ajax-success="window.fake.success" id="append638499940937885592948_PartialSimpleNew" method="post" style="display: inline;">        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%;" class="content_table_03_title">
                        人員類別
                    </td>
                    <td class="content_table_04_content">
                        <select class="textfield_must" id="StaffCatalog" name="StaffCatalog"><option selected="selected" value="1">1.教職</option>
<option value="2">2.學生</option>
<option value="4">4.校外</option>
</select>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="StaNum">學(代)號</label>
                    </td>
                    <td class="content_table_04_content">
                        <input class="textfield_must" data-val="true" data-val-length="欄位 學(代)號 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-required="學(代)號 欄位是必要項。" id="StaNumE" maxlength="10" name="StaNum" onBlur="SimName();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <a href="https://webapp.nccu.edu.tw/SSO2/AppTransfer.aspx?sid=152&g=n" target="_blank">
                            校外人士資料維護</a>
                        <span class="field-validation-valid" data-valmsg-for="StaNum" data-valmsg-replace="true"></span><br />
                        <div id="stmsg3" style="color: Red; display: inline;">
                        </div>
                        <br /><label for="">校外人士若輸入身分證字號，系統會自動帶出代號!</label>
                        <br />
                        <span id="stmsg_si" style="color: Red; display: none; white-space: pre-wrap;">『注意！！此人為本校退休人員，教育人員及公務人員退休再任每月領取金額超過法定基本工資者，應停發月退休金。請再次協助告知當事人，如有核發疑義，請洽詢人事室三組，分機63511』</span>
                        <span id="stmsg_si2" style="color: Red; display: none; white-space: pre-wrap;">『注意！！此人為外籍人士，若於本課稅年度在台灣居留未滿183日，應依非本地居住者之稅率代扣稅款（請參考出納組網頁各類所得扣繳率簡表）。如有疑義，請洽總務處出納組，分機62172』</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="Name">姓名</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="NameELbl" style="display: inline">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="Account">帳別</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="AccountELbl" style="display: inline">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="WorkYM">支領年月</label>
                    </td>
                    <td class="content_table_04_content">
                        <label for="">民國</label>
                        <select class="textfield_must" id="WorkYYDDLC" name="WorkYYDDLC" onchange=""><option value="2025">114</option>
<option selected="selected" value="2024">113</option>
<option value="2023">112</option>
</select>
                        <label for="">年</label>
                        <select class="textfield_must" id="WorkMMDDLC" name="WorkMMDDLC" onchange=""><option value="01">1</option>
<option value="02">2</option>
<option value="03">3</option>
<option selected="selected" value="04">4</option>
<option value="05">5</option>
<option value="06">6</option>
<option value="07">7</option>
<option value="08">8</option>
<option value="09">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
</select>
                        <label for="">月</label>
                        <br />
                        應支領該款項之年度月份,不同月份請依月份個別輸入
                        <input Value="202404" data-val="true" data-val-length="支領年月格式錯誤" data-val-length-max="6" id="WorkYMC" maxlength="6" name="WorkYM" style="visibility:hidden;" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="WorkYM" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        款項 <input class="textfield_must" data-val="true" data-val-required="款項代碼 欄位是必要項。" id="SalTpeE" name="SalTpe" style="visibility:hidden" type="text" value="" />
                    </td>
                    <td class="content_table_04_content">
                        <select class="textfield_must" id="salCG2E" name="SalCatalog2"><option selected="selected" value="">0全部</option>
<option value="1">101各類薪資</option>
<option value="2">102各類退休金離職金</option>
<option value="3">103各類補助費</option>
<option value="4">104教職員各類工作費</option>
<option value="5">105各類試務工作費</option>
<option value="6">106教師各類費用</option>
<option value="7">203各類公費</option>
<option value="8">204各類貸款</option>
<option value="9">205學生其他</option>
<option value="10">301各類費用</option>
<option value="11">401退稅</option>
<option value="12">402退費</option>
<option value="13">403退各類保費</option>
<option value="14">404退各類學雜費</option>
<option value="15">405退各類押保證金</option>
<option value="16">406退宿舍停車管理費</option>
<option value="17">407退冷氣設備費</option>
</select>
                        <select class="textfield_must" id="salCG3E" name="SalCatalog3"><option selected="selected" value="">請選擇</option>
<option value="1">10102非固定薪資</option>
<option value="2">10103津貼</option>
<option value="3">10104夜間津貼</option>
<option value="4">10105晉級調薪差額</option>
<option value="5">10106考績獎金</option>
<option value="6">10107考績獎金及晉級差額</option>
<option value="7">10108年終獎金</option>
<option value="8">10110加班費</option>
<option value="9">10112主管加給</option>
<option value="10">10113值班費</option>
<option value="11">10114交通費</option>
<option value="12">10115差旅費</option>
<option value="13">10116兼職費</option>
<option value="14">10119專業加給</option>
<option value="15">10120特教加給</option>
<option value="16">10123考核獎金</option>
<option value="17">10124特別休假未休畢折工資</option>
<option value="18">10125調薪補差</option>
<option value="19">10201退休(職)金</option>
<option value="20">10202月退休金</option>
<option value="21">10203慰問金</option>
<option value="22">10204撫慰金</option>
<option value="23">10205其他現金補償金</option>
<option value="24">10206撫卹金</option>
<option value="25">10207自提儲金</option>
<option value="26">10208退休獎章獎勵金</option>
<option value="27">10209公提儲金</option>
<option value="28">10210資遣費</option>
<option value="29">10211公保超額年金</option>
<option value="30">10301補助費(補助個人)</option>
<option value="31">10302生育補助費</option>
<option value="32">10303員工喪葬補助費</option>
<option value="33">10304結婚補助費</option>
<option value="34">10305健檢補助費</option>
<option value="35">10306教育補助費</option>
<option value="36">10307休假旅遊補助費</option>
<option value="37">10308戶外休閒活動補助費</option>
<option value="38">10309研究(進修)補助費</option>
<option value="39">10310補助機票款</option>
<option value="40">10312福利互助結算金</option>
<option value="41">10313超休休假補助費</option>
<option value="42">10314眷屬喪葬補助費</option>
<option value="43">10315未休假加班費</option>
<option value="44">10316禮金(禮券)</option>
<option value="45">10317講座教授學術研究補助</option>
<option value="46">10318特聘教授獎助費</option>
<option value="47">10319新聘助理教授增核學術</option>
<option value="48">10320教學優良特優教師獎勵</option>
<option value="49">10321研究優良教師獎勵金</option>
<option value="50">10322自籌收入之工作酬勞</option>
<option value="51">10323房屋津貼</option>
<option value="52">10324傑出人才學術研究補助</option>
<option value="53">10325科技部延攬補助費</option>
<option value="54">10326學習津貼</option>
<option value="55">10327資深優良教師獎勵</option>
<option value="56">10402國科會行政工作費</option>
<option value="57">10501試務工作費</option>
<option value="58">10502監試費</option>
<option value="59">10503巡視費</option>
<option value="60">10504招生命題/閱卷費</option>
<option value="61">10505資格考命題/閱卷費</option>
<option value="62">10507試務-報到工作費</option>
<option value="63">10508試務-製卷工作費</option>
<option value="64">10509試務-查分工作費</option>
<option value="65">10510放榜工作費</option>
<option value="66">10511試務-佈置工作費</option>
<option value="67">10601研究獎勵金</option>
<option value="68">10602鐘點費</option>
<option value="69">10603導師費(限出納組造冊)</option>
<option value="70">10604代課費</option>
<option value="71">10605導護費</option>
<option value="72">10606教學研究費</option>
<option value="73">10607課程研究費</option>
<option value="74">10608課程開發費</option>
<option value="75">10609教材編輯費</option>
<option value="76">10610講義編篡費</option>
<option value="77">10611輔導費</option>
<option value="78">10612導師活動費</option>
<option value="79">10613論文指導費</option>
<option value="80">10614社團指導費</option>
<option value="81">10616實習津貼</option>
<option value="82">10617教材上網補助費</option>
<option value="83">10618其他費用</option>
<option value="84">10619傑出研究獎助金</option>
<option value="85">10620報告指導費</option>
<option value="86">10621檢據教材費</option>
<option value="87">10622服務課程指導費</option>
<option value="88">10623獎勵金</option>
<option value="89">10624評論費</option>
<option value="90">20301僑生公費</option>
<option value="91">20302遺族公費</option>
<option value="92">20303公費</option>
<option value="93">20401就貸書籍費</option>
<option value="94">20402就貸海外研修費</option>
<option value="95">20403就貸生活費</option>
<option value="96">20404就貸校外住宿費</option>
<option value="97">20501急難救助金</option>
<option value="98">20502宿舍清潔保證金</option>
<option value="99">20503生活救助金</option>
<option value="100">30101獎金(獎品)</option>
<option value="101">30103審查費</option>
<option value="102">30104畢業論文審查費</option>
<option value="103">30105畢業論文計劃審查費</option>
<option value="104">30106學報審查費</option>
<option value="105">30107稿費</option>
<option value="106">30108學報論文稿費</option>
<option value="107">30109演講費</option>
<option value="108">30110整合作業費</option>
<option value="109">30111資料蒐集費</option>
<option value="110">30112資料檢索費</option>
<option value="111">30113諮詢委員費</option>
<option value="112">30114出席費</option>
<option value="113">30115主持費</option>
<option value="114">30116顧問費</option>
<option value="115">30118調查訪問(談)費</option>
<option value="116">30119規劃費</option>
<option value="117">30120預借款</option>
<option value="118">30121筆譯費</option>
<option value="119">30122表演人演出費</option>
<option value="120">30123研究報告撰寫費</option>
<option value="121">30124編稿費(按字計酬)</option>
<option value="122">30125畢業論文口試費</option>
<option value="123">30126論文發表費</option>
<option value="124">30127論文評論費</option>
<option value="125">30128口試費</option>
<option value="126">30129租金</option>
<option value="127">30130研究討論費</option>
<option value="128">30131傑出績優獎勵金</option>
<option value="129">30132權利金(版權費)</option>
<option value="130">30133律師費</option>
<option value="131">30134技師費</option>
<option value="132">30135建築師</option>
<option value="133">30136表演人</option>
<option value="134">30137內科醫師</option>
<option value="135">30138外科醫師</option>
<option value="136">30139其他所得</option>
<option value="137">30140程式設計師</option>
<option value="138">30141住宿費用</option>
<option value="139">30142執行業務所得(其他)</option>
<option value="140">40101退所得稅</option>
<option value="141">40201退費</option>
<option value="142">40202退外撥電話費</option>
<option value="143">40203退貸款利息</option>
<option value="144">40204退水電費</option>
<option value="145">40205退房租津貼</option>
<option value="146">40206退撫基金退還</option>
<option value="147">40207退冷氣設備費</option>
<option value="148">40208退宿舍保證金</option>
<option value="149">40209退請假扣薪溢扣</option>
<option value="150">40301退公勞保費</option>
<option value="151">40302退健保費</option>
<option value="152">40303退外籍生保費</option>
<option value="153">40304退僑生保費</option>
<option value="154">40305退平安保險費</option>
<option value="155">40401退學雜費</option>
<option value="156">40402退學分費</option>
<option value="157">40403退語言設備</option>
<option value="158">40404退資訊設備費</option>
<option value="159">40405退宿費</option>
<option value="160">40406退延誤註冊費</option>
<option value="161">40407退自十宿費</option>
<option value="162">40408退新生區宿費</option>
<option value="163">40501退押金</option>
<option value="164">40502退保證金</option>
<option value="165">40503退清潔保證金</option>
<option value="166">40601退宿舍停車管理費</option>
</select><br />
                        <span class="field-validation-valid" data-valmsg-for="SalTpe" data-valmsg-replace="true"></span>
                        <div id="satmsg3" style="color: Red; display: inline;">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
<label for="">１、若該款項需預扣所得稅，系統將自動帶出應扣稅額。</label><br />
<label for="">２、款項若為二代健保補充保費課徵項目與對象，系統將自動帶出金額。</label>        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        應支金額
                    </td>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        雇主負擔
                    </td>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        所得人負擔
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="UnitPrice">單價</label>
                    </td>
                    <td class="content_table_04_content">
                        <input class="textfield_must simEGD positive-integer zero" data-val="true" data-val-length="欄位 單價 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 單價 must be a number." data-val-range="單價不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" data-val-required="單價 欄位是必要項。" id="UnitPriceE" maxlength="10" name="UnitPrice" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="UnitPrice" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinBoss2">健補(雇主)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健補(雇主) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健補(雇主) must be a number." data-val-required="健補(雇主) 欄位是必要項。" id="FinBoss2E" maxlength="10" name="FinBoss2" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinBoss2" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="Tax">所得稅</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 所得稅 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 所得稅 must be a number." data-val-range="所得稅不得為負值" data-val-range-max="2147483647" data-val-range-min="0" data-val-required="所得稅 欄位是必要項。" id="TaxE" maxlength="10" name="Tax" onBlur="SimECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Tax" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="Quantity">數量</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="1" class="textfield_must simEGD positive-integer zero" data-val="true" data-val-length="欄位 數量 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 數量 must be a number." data-val-range="數量不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" data-val-required="數量 欄位是必要項。" id="QuantityE" maxlength="10" name="Quantity" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Quantity" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_content" colspan="2" rowspan="2">
                    </td>
                    <td class="content_table_04_title">
                        <label for="">其他扣款</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 其他扣款 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 其他扣款 must be a number." data-val-required="其他扣款 欄位是必要項。" id="OtherE" maxlength="10" name="Other" onBlur="SimECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Other" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="Amount">金額</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="AmountELbl" style="display: inline;">
                        </div>
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinFee2">健補(自付)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健補(自付) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健補(自付) must be a number." data-val-required="健補(自付) 欄位是必要項。" id="FinFee2E" maxlength="10" name="FinFee2" onBlur="SimECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinFee2" data-valmsg-replace="true"></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="TotalAmount">實發金額</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="TotalAmountELbl" style="display: inline;">
                        </div>
                        <span class="field-validation-valid" data-valmsg-for="TotalAmount" data-valmsg-replace="true"></span>
                        <input data-val="true" data-val-length="欄位 實發金額 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 實發金額 must be a number." data-val-range="實發金額不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" id="TotalAmountE" name="TotalAmount" style="visibility: hidden;" type="text" value="" />
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="Memo">備註(最多30個中文字)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input data-val="true" data-val-length="欄位 備註(最多30個中文字) 必須是最大長度為 30 的字串。" data-val-length-max="30" id="MemoE" maxlength="30" name="Memo" onKeyPress="return disableEnterKey(event)" style="width:400px" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="Memo" data-valmsg-replace="true"></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <div style="padding-top: 5px">
            <div style="text-align: center;">
                <input id="newSimpleBtn2" type="submit" value="確認" disabled="disabled" class="iput_btn_disabled" onclick="window.$form = $('form#append_PartialSimpleNew638499940937885592');" />
                
                <input class="ResetBtn" type="reset" value="清除" style="display: none" />
                <input class="iput_btn" type="button" value="關閉" onclick="$('#SimpleNewDialog2').dialog('close');$('.ResetBtn').click();ClearAll();" />
            </div>
        </div>
</form>    <br />
</div>
<script type="text/javascript">
//<![CDATA[
    $(function () {
        // 支領年
        $('#WorkYYDDLC').change(function () {
            $('#WorkYMC').val($("#WorkYYDDLC option:selected").val() + $("#WorkMMDDLC option:selected").val());
        });
        // 支領月
        $('#WorkMMDDLC').change(function () {
            $('#WorkYMC').val($("#WorkYYDDLC option:selected").val() + $("#WorkMMDDLC option:selected").val());
        });
    });
    //]]>
</script>

<div id="SalaryNewDialog2" style="display: none;">
<form action="/GE/GE06/GE0601/Home/FNew" data-ajax="true" data-ajax-begin="window.fake.beginfake" data-ajax-complete="window.fake.complete" data-ajax-failure="window.fake.failure" data-ajax-success="window.window.fake.success" id="append638499940937885592948_PartialSalaryNew" method="post" style="display: inline;">        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        人員類別
                        <input type="hidden" id="utcod" value="300" />
                    </td>
                    <td class="content_table_04_content">
                        <select class="textfield_must" id="StaffCatalog4" name="StaffCatalog4"><option selected="selected" value="1">1.教職</option>
<option value="2">2.學生</option>
<option value="4">4.校外</option>
</select>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="StaNum">學(代)號</label>
                    </td>
                    <td class="content_table_04_content">
                        <input class="textfield_must" data-val="true" data-val-length="欄位 學(代)號 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-required="學(代)號 欄位是必要項。" id="StaNumF" maxlength="10" name="StaNum" onBlur="SalName();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <a href="https://webapp.nccu.edu.tw/SSO2/AppTransfer.aspx?sid=152&g=n" target="_blank">
                            校外人士資料維護</a>
                        <span class="field-validation-valid" data-valmsg-for="StaNum" data-valmsg-replace="true"></span><br />
                        <div id="stmsg4" style="color: Red; display: inline;">
                        </div>
                        <br /><label for="">校外人士若輸入身分證字號，系統會自動帶出代號!</label>
                        <br />
                        <span id="stmsg_sa" style="color: Red; display: none; white-space: pre-wrap;">『注意！！此人為本校退休人員，教育人員及公務人員退休再任每月領取金額超過法定基本工資者，應停發月退休金。請再次協助告知當事人，如有核發疑義，請洽詢人事室三組，分機63511』</span>
                        <span id="stmsg_sa2" style="color: Red; display: none; white-space: pre-wrap;">『注意！！此人為外籍人士，若於本課稅年度在台灣居留未滿183日，應依非本地居住者之稅率代扣稅款（請參考出納組網頁各類所得扣繳率簡表）。如有疑義，請洽總務處出納組，分機62172』</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="Name">姓名</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="NameFLbl" style="display: inline">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="Account">帳別</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="AccountFLbl" style="display: inline">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="WorkYM">支領年月</label>
                    </td>
                    <td class="content_table_04_content">
                        <label for="">民國</label>
                        <select class="textfield_must" id="WorkYYDDLS" name="WorkYYDDLS" onchange=""><option value="2025">114</option>
<option selected="selected" value="2024">113</option>
<option value="2023">112</option>
</select>
                        <label for="">年</label>
                        <select class="textfield_must" id="WorkMMDDLS" name="WorkMMDDLS" onchange=""><option value="01">1</option>
<option value="02">2</option>
<option value="03">3</option>
<option selected="selected" value="04">4</option>
<option value="05">5</option>
<option value="06">6</option>
<option value="07">7</option>
<option value="08">8</option>
<option value="09">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
</select>
                        <label for="">月</label>
                        <br />
                        應支領該款項之年度月份,不同月份請依月份個別輸入
                        <input Value="202404" data-val="true" data-val-length="支領年月格式錯誤" data-val-length-max="6" id="WorkYMS" maxlength="6" name="WorkYM" style="visibility:hidden;" type="text" value="" />
                        <span class="field-validation-valid" data-valmsg-for="WorkYM" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title">
                        款項
                    </td>
                    <td class="content_table_04_content" colspan="3">
                        <select class="textfield_must" id="salCG4E" name="SalCatalog4"><option value="1">10101薪資</option>
<option value="2">10105晉級調薪差額</option>
<option value="3">10107考績獎金及晉級差額</option>
<option value="4">10317講座教授學術研究補助</option>
<option value="5">20108教學助理薪資</option>
</select>
                        <input class="textfield_must" data-val="true" data-val-required="款項代碼 欄位是必要項。" id="SalTpeF" name="SalTpe" style="visibility:hidden" type="text" value="" />
                        <div id="satmsg4" style="color: Red; display: inline;">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
<label for="">１、若該款項需預扣所得稅，系統將自動帶出應扣稅額。</label><br />
<label for="">２、款項若為二代健保補充保費課徵項目與對象，系統將自動帶出金額。</label>        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        應支金額
                    </td>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        雇主負擔
                    </td>
                    <td style="width: 33%;" class="content_table_04_title" colspan="2">
                        所得人負擔
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="UnitPrice">單價</label>
                    </td>
                    <td class="content_table_04_content">
                        <input class="textfield_must salEGD positive-integer zero" data-val="true" data-val-length="欄位 單價 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 單價 must be a number." data-val-range="單價不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" data-val-required="單價 欄位是必要項。" id="UnitPriceF" maxlength="10" name="UnitPrice" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="UnitPrice" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="RetBoss">勞退(雇主)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 勞退(雇主) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 勞退(雇主) must be a number." data-val-required="勞退(雇主) 欄位是必要項。" id="RetBossF" maxlength="10" name="RetBoss" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="RetBoss" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="Tax">所得稅</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 所得稅 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 所得稅 must be a number." data-val-range="所得稅不得為負值" data-val-range-max="2147483647" data-val-range-min="0" data-val-required="所得稅 欄位是必要項。" id="TaxF" maxlength="10" name="Tax" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Tax" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="Quantity">數量</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="1" class="textfield_must salEGD positive-integer zero" data-val="true" data-val-length="欄位 數量 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 數量 must be a number." data-val-range="數量不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" data-val-required="數量 欄位是必要項。" id="QuantityF" name="Quantity" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Quantity" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="InsBoss">勞保(雇主)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 勞保(雇主) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 勞保(雇主) must be a number." data-val-required="勞保(雇主) 欄位是必要項。" id="InsBossF" maxlength="10" name="InsBoss" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="InsBoss" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="RetFee">退撫基金/勞退(自付)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 退撫基金/勞退(自付) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 退撫基金/勞退(自付) must be a number." data-val-required="退撫基金/勞退(自付) 欄位是必要項。" id="RetFeeF" maxlength="10" name="RetFee" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="RetFee" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="Amount">金額</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="AmountFLbl" style="display: inline;">
                        </div>
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinBoss">健保(雇主)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健保(雇主) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健保(雇主) must be a number." data-val-required="健保(雇主) 欄位是必要項。" id="FinBossF" maxlength="10" name="FinBoss" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinBoss" data-valmsg-replace="true"></span>
                    </td>
                    <td style="width: 33%;" class="content_table_04_title">
                        <label for="InsFee">公勞保(自付)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 公勞保(自付) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 公勞保(自付) must be a number." data-val-required="公勞保(自付) 欄位是必要項。" id="InsFeeF" maxlength="10" name="InsFee" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="InsFee" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title" rowspan="4" colspan="2">
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinBoss2">健補(雇主)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健補(雇主) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健補(雇主) must be a number." data-val-required="健補(雇主) 欄位是必要項。" id="FinBoss2F" maxlength="10" name="FinBoss2" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinBoss2" data-valmsg-replace="true"></span>
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinFee">健保(自付)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健保(自付) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健保(自付) must be a number." data-val-required="健保(自付) 欄位是必要項。" id="FinFeeF" maxlength="10" name="FinFee" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinFee" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title" rowspan="3" colspan="2">
                    </td>
                    <td class="content_table_04_title">
                        <label for="FinFee2">健補(自付)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 健補(自付) 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 健補(自付) must be a number." data-val-required="健補(自付) 欄位是必要項。" id="FinFee2F" maxlength="10" name="FinFee2" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="FinFee2" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="HelFee">請假扣薪</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 請假扣薪 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 請假扣薪 must be a number." data-val-required="請假扣薪 欄位是必要項。" id="HelFeeF" maxlength="10" name="HelFee" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="HelFee" data-valmsg-replace="true"></span>
                    </td>
                </tr>
                <tr>
                    <td class="content_table_04_title">
                        <label for="Other">其他扣款</label>
                    </td>
                    <td class="content_table_04_content">
                        <input Value="0" class="textfield_must positive-integer zero" data-val="true" data-val-length="欄位 其他扣款 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 其他扣款 must be a number." data-val-required="其他扣款 欄位是必要項。" id="OtherF" maxlength="10" name="Other" onBlur="SalECalDollar();" onKeyPress="return disableEnterKey(event)" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Other" data-valmsg-replace="true"></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <table width="100%" cellspacing="0" cellpadding="5" border="0" style="display: table;"
            class="content_table_06">
            <tbody>
                <tr>
                    <td style="width: 33%" class="content_table_04_title">
                        <label for="TotalAmount">實發金額</label>
                    </td>
                    <td class="content_table_04_content">
                        <div id="TotalAmountFLbl" style="display: inline;">
                        </div>
                        <span class="field-validation-valid" data-valmsg-for="TotalAmount" data-valmsg-replace="true"></span>
                        <input data-val="true" data-val-length="欄位 實發金額 必須是最大長度為 10 的字串。" data-val-length-max="10" data-val-number="The field 實發金額 must be a number." data-val-range="實發金額不得為負值" data-val-range-max="1.79769313486232E+308" data-val-range-min="0" id="TotalAmountF" name="TotalAmount" style="visibility: hidden;" type="text" value="" />
                    </td>
                </tr>
                <tr>
                    <td style="width: 33%" class="content_table_04_title">
                        <label for="Memo">備註(最多30個中文字)</label>
                    </td>
                    <td class="content_table_04_content">
                        <input data-val="true" data-val-length="欄位 備註(最多30個中文字) 必須是最大長度為 30 的字串。" data-val-length-max="30" id="MemoF" maxlength="30" name="Memo" onKeyPress="return disableEnterKey(event)" style="width:400px" type="text" value="" />
                        <br /><span class="field-validation-valid" data-valmsg-for="Memo" data-valmsg-replace="true"></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <div style="padding-top: 5px">
            <div style="text-align: center;">
                <input id="newSalaryBtn2" type="submit" value="確認" disabled="disabled" class="iput_btn_disabled" onclick="window.$form = $('form#append_PartialSalaryNew638499940937885592');" />
                
                <input class="ResetBtn" type="reset" value="清除" style="display: none" />
                <input class="iput_btn" type="button" value="關閉" onclick="$('#SalaryNewDialog2').dialog('close');$('.ResetBtn').click();ClearAll();" />
            </div>
        </div>
</form>    <br />
</div>
<script type="text/javascript">
//<![CDATA[
    $(function () {
        // 支領年
        $('#WorkYYDDLS').change(function () {
            $('#WorkYMS').val($("#WorkYYDDLS option:selected").val() + $("#WorkMMDDLS option:selected").val());
        });
        // 支領月
        $('#WorkMMDDLS').change(function () {
            $('#WorkYMS').val($("#WorkYYDDLS option:selected").val() + $("#WorkMMDDLS option:selected").val());
        });
    });
    //]]>
</script>

<div id="table_container" class="result_list" style="display: none;">
</div>
<div class="EditForm" title="編輯申請單" style="display: none;">
</div>
<script type="text/javascript">
    // 流通文號
    var odnum;
    // 自動完成
    var keys = "";
    // 暫存欲改變之金額
    var temp;

    // Press Enter
    jQuery.Event.prototype.isEnter = function () {
        return this.which == 13;
    };
    (function($)
    {
        jQuery.fn.setfocus = function()
        {
            return this.each(function()
            {
                var dom = this;
                setTimeout(function()
                {
                    try { dom.focus(); } catch (e) { }
                }, 0);
            });
        };
    })(jQuery);
    $(function () {

        $("#msg2").text("");
        $('#stmsg_si').hide();
        $('#stmsg_sa').hide();
        $('#stmsg_si2').hide();
        $('#stmsg_sa2').hide();

        $("#EditMode,.emptytr").hide();
        var smsg = $("#msg").val();
        if(smsg != "")
            $.getValidationSummary().html(smsg);

        document.onkeydown = stopRKey;

        //退休 check
        var arr = ["10201", "10202", "10203", "10204", "10205","10208","10210","10306"];

    $('select[name=SalCatalog3]').change(function() {

        //var type = $("#StaffCatalog3").val();
        var type = $("#StaffCatalog").val();
        var no = $("#StaNumE").val();
         $.post('/GE/GE06/GE0601/Home/chkIsRet', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog3] :selected').text().substr(0,5);
                if( data== true && arr.indexOf(sal)==-1 ) {
                    $('#stmsg_si').show();
                }
                else
                {
                    $('#stmsg_si').hide();
                }

            });

         $.post('/GE/GE06/GE0601/Home/chkIsFor', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog3] :selected').text().substr(0,5);
                if( data== true) {
                    $('#stmsg_si2').show();
                }
                else
                {
                    $('#stmsg_si2').hide();
                }

            });
    });
    $('select[name=SalCatalog4]').change(function() {
         //var type = $("#StaffCatalog4").val();
         var type = $("#StaffCatalog4").val();
         var no = $("#StaNumF").val();
         $.post('/GE/GE06/GE0601/Home/chkIsRet', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog4] :selected').text().substr(0,5);
                if( data== true && arr.indexOf(sal)==-1 ) {
                    $('#stmsg_sa').show();
                }
                else
                {
                    $('#stmsg_sa').hide();
                }

            });

         $.post('/GE/GE06/GE0601/Home/chkIsFor', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog4] :selected').text().substr(0,5);
                if( data== true) {
                    $('#stmsg_sa2').show();
                }
                else
                {
                    $('#stmsg_sa2').hide();
                }

            });
    });

        $("#st_paydt,#ed_paydt,#st_trandt,#ed_trandt").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: "yy/mm/dd"
        });
        $(".positive-integer").numeric({ decimal: false, negative: false }, function () {
            var container = $("[data-valmsg-for='" + $(this).attr('name') + "']");
            container.removeClass("field-validation-valid").addClass("field-validation-error");
            container.html("欄位值必須是數字");
            $(this).val('');
            $(this).focus();
        });
        $(".zero").focusout(function() {
            if($(this).val().length >= 2 && $(this).val().substr(0,1) == 0) {
                var container = $("[data-valmsg-for='" + $(this).attr('name') + "']");
                container.removeClass("field-validation-valid").addClass("field-validation-error");
                container.html("數值格式不正確");
                $(this).val('');
                $(this).focus();
            }
        });
        // 簡式新增第一類
        $('#salCG2E').change(function () {
            var type = $("#salCG2E option:selected").text().substr(0,3);
            $.getJSON('/GE/GE06/GE0601/Home/Get3rdSalType', { type: type, lvl: '3' }, function(data) {
                $('#salCG3E').empty();
                $('#salCG3E').append($('<option></option>').val('').text('請選擇'));
                $('#salCG3E').append(data);
            });
            ClearMoney();
            $('#SalTpeE').val('');
        });
        // 簡式新增第二類
        $('#salCG3E').change(function () {
            $('#SalTpeE').val($("#salCG3E option:selected").text());
            ClearMoney();
            if($("#salCG3E option:selected").text() == "請選擇")
                $('#SalTpeE').val('');
        });
        // 薪資新增
        $('#salCG4E').change(function () {
            $('#SalTpeF').val($("#salCG4E option:selected").text());
            ClearMoney();
        });
        /////////////////////////////////////////////////////////////////////////////////////////
        // 列印清冊號
        $('#dfPyNumDDL').change(function () {
            $('#dfPyNum').val($("#dfPyNumDDL option:selected").val());
        });
        // 複製清冊號
        $('#dfCpNumDDL').change(function () {
            $('#dfCpNum').val($("#dfCpNumDDL option:selected").val());
        });
        /////////////////////////////////////////////////////////////////////////////////////////
        $("input:text").keydown(function (e) {
            if (e.isEnter()) {
                $(this).trigger("enterPressed", e);
            }
        });
        $("#StaNumE").bind("enterPressed", function () {
            SimName();
        });
        // Get學(代)號-Salary
        $("#StaNumF").bind("enterPressed", function () {
            SalName();
        });
        $('#StaffCatalog').change(function () {
            ClearSome();
        });
        // $('#StaffCatalog4').change(function () {
        //    ClearSome();
        //});
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // 編輯－簡式新增
        $('#newSimpleBtn2').live('click', function () {
            var st = $("input[id='SalTpeE']").val().toString();
            var saltpe = st.substring(0,5);
            var salnam = st.substring(5,st.length);

            var sta_num    = $("input[id='StaNumE']").val();
            var chi_nam    = $("div[id='NameELbl']").text();
            var account    = $("div[id='AccountELbl']").text();
            var sal_tpe    = saltpe;
            var yy         = $("#WorkYYDDLC").val();
            var mm         = $("#WorkMMDDLC").val();
            var sal_nam    = salnam;
            var unit_price = $("input[id='UnitPriceE']").val();
            var amount     = $("input[id='QuantityE']").val();
            var dollar     = $("input[id='UnitPriceE']").val() * $("input[id='QuantityE']").val();
            var tax        = $("input[id='TaxE']").val();
            var fin_fee2   = $("input[id='FinFee2E']").val();
            var fin_boss2  = $("input[id='FinBoss2E']").val();
            var other      = $("input[id='OtherE']").val();
            var income     = $("input[id='TotalAmountE']").val();
            var memo       = $("input[id='MemoE']").val();

            var flag = (sta_num   != "" && chi_nam != "" && saltpe   != "" && unit_price != "" &&
                        amount    != "" && tax     != "" && fin_fee2 != "" &&
                        fin_boss2 != "" && memo.length <= 30 && $("div[id='TotalAmountELbl']").text() != "" &&
                        income    >= 0  && income != "" && isNum($("#AmountELbl").text().replace(",","")) && // 判斷金額沒有超過99萬元
                        $('#stmsg3').text().length == 0);

            if (CheckSimpleNew()) {
                if(flag) {
                    var staffcatalog = $("#StaffCatalog option:selected").text();

                    pNum       = $("div[id='pnumeditlblL']").text();
                    p_kd       = staffcatalog.substr(0,1) == "1" ? "職" : (staffcatalog.substr(0,1) == "2" ? "學" : "外");

                    $("#newSimpleBtn2").prop('disabled', true);
                    $("#newSimpleBtn2").removeClass( 'iput_btn').addClass('iput_btn_disabled');
                    //debugger;
                    // 新增明細檔
                    $.ajax({
                        type: 'POST',
                        url: 'Home/NewE',
                        data: { pnum:pNum, stanum:sta_num, pkd:p_kd, chinam:chi_nam, yy:yy, mm:mm, saltpe:sal_tpe, salnam:sal_nam, unitprice:unit_price, amount:amount,
                                dollar:dollar, tax:tax, insfee:0, insboss:0, finfee:0, finboss:0, finfee2:fin_fee2, finboss2:fin_boss2,
                                retfee:0, retboss:0, helfee:0, other:other, income:income, memo:memo},
                        success: function(data) {
                                addRowE(data,1);
                                $.post('/GE/GE06/GE0601/Home/GetTotal', { pn: pNum, type: "add" }, function(data) {
                                    addRowCal(data);
                                });
                        }
                    });
                }
            };
        });
        // 編輯－薪資新增
        $('#newSalaryBtn2').live('click', function () {
            //debugger;
            var std = $("input[id='SalTpeF']").val().toString();
            var saltpe = std.substring(0,5);
            var salnam = std.substring(5,std.length);

            var sta_num    = $("input[id='StaNumF']").val();
            var yy         = $("#WorkYYDDLS").val();
            var mm         = $("#WorkMMDDLS").val();
            var chi_nam    = $("div[id='NameFLbl']").text();
            var account    = $("div[id='AccountFLbl']").text();
            var unit_price = $("input[id='UnitPriceF']").val();
            var amount     = $("input[id='QuantityF']").val();
            var dollar     = $("input[id='UnitPriceF']").val() * $("input[id='QuantityF']").val();
            var tax        = $("input[id='TaxF']").val();
            var ins_fee    = $("input[id='InsFeeF']").val();
            var ins_boss   = $("input[id='InsBossF']").val();
            var fin_fee    = $("input[id='FinFeeF']").val();
            var fin_boss   = $("input[id='FinBossF']").val();
            var fin_fee2   = $("input[id='FinFee2F']").val();
            var fin_boss2  = $("input[id='FinBoss2F']").val();
            var ret_fee    = $("input[id='RetFeeF']").val();
            var ret_boss   = $("input[id='RetBossF']").val();
            var hel_fee    = $("input[id='HelFeeF']").val();
            var other      = $("input[id='OtherF']").val();
            var income     = $("input[id='TotalAmountF']").val();
            var memo       = $("input[id='MemoF']").val();

            var flag = (sta_num    != "" && std      != "" && chi_nam  != "" &&
                        unit_price != "" && amount   != "" && tax      != "" &&
                        ins_boss   != "" && fin_boss != "" && fin_fee2 != "" &&
                        fin_boss2  != "" && ret_boss != "" && ins_fee  != "" &&
                        fin_fee    != "" && ret_fee  != "" && hel_fee  != "" &&
                        other      != "" && memo.length <= 30 && income >= 0 &&
                        income != "" && isNum($("#AmountFLbl").text().replace(",","")) && // 判斷金額沒有超過99萬元
                        $('#stmsg4').text().length == 0);

            if((fin_boss > 0 || fin_fee > 0) && (fin_boss2 > 0 || fin_fee2 > 0) && $("#utcod").val() != "162" && $("#utcod").val() != "Z07")
            {
                alert("『健保自付/雇主』與二代健保補充保費之『健補自付/雇主』請擇一登錄！");
                flag = false;
            }

            if (CheckSalaryNew()) {
                if(flag) {
                    var staffcatalog = $("#StaffCatalog4 option:selected").text();

                    var pNum    = $("div[id='pnumeditlblL']").text();
                    var p_kd    = staffcatalog.substr(0,1) == "1" ? "職" : (staffcatalog.substr(0,1) == "2" ? "學" : "外");

                    $("#newSalaryBtn2").prop('disabled', true);
                    $("#newSalaryBtn2").removeClass( 'iput_btn').addClass('iput_btn_disabled');
                    //debugger;
                    $.ajax({
                        type: 'POST',
                        url: 'Home/NewE',
                        data: { pnum:pNum, stanum:sta_num, pkd:p_kd, chinam:chi_nam, yy:yy, mm:mm, saltpe:saltpe, salnam:salnam, unitprice:unit_price, amount:amount,
                                dollar:dollar, tax:tax, insfee:ins_fee, insboss:ins_boss, finfee:fin_fee, finboss:fin_boss, finfee2:fin_fee2, finboss2:fin_boss2,
                                retfee:ret_fee, retboss:ret_boss, helfee:hel_fee, other:other, income:income, memo:memo },
                        success: function(data) {
                            addRowE(data,2);
                            $.post('/GE/GE06/GE0601/Home/GetTotal', { pn: pNum, type: "add" }, function(data) {
                                addRowCal(data);
                            });
                        }
                    });
                }
            };
        });
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // 產生報表
        $('#ReportBtn').live('click', function () {
            var flag = true;
            var pnum = $("#dfPyNumDDL option:selected").val();

            if(pnum == "") {
                $('#pmsg').text("清冊號 欄位是必要項。");
                flag = false;
            }

            if(flag) {
                $.getJSON('/GE/GE06/GE0601/Home/GetPPaylstNum', {pn: pnum}, function(data) {
                    if(data == null) {
                        $('#pmsg').text("無此清冊號，請重新輸入。");
                    }
                    else {
                        $('#PrintReportBtn').click();
                        $('#pmsg').text('');
                    }
                });
            }
        });
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // 拷貝主檔
        $('#CopyNewBtn').live('click', function () {
            var flag = true;
            var cpnum = $('#dfCpNum').val();
            var td = "<td style='text-align: center;' class='content_table_04_content'>";

            if(cpnum == ""){
                $('#cmsg').text("清冊號 欄位是必要項。");
                flag = false;
            }

            if(flag) {
                $.getJSON('/GE/GE06/GE0601/Home/GetCPaylstNum', {pn: cpnum}, function(data) {
                    if(data == null) {
                        $('#cmsg').text("無此清冊號，請重新輸入。");
                        $('#dfCpNum').val('');
                    }
                    else if(data.pay_tpe == "2") {
                        $('#cmsg').text("該清冊為現金清冊，不得在清冊系統複製。");
                        $('#dfCpNum').val('');
                    }
                    else {
                        $('#CopyMode').show();
                        // 計算行數
                        rowCount = $('#cpcontext tr').length;

                        for(var i = 0; i < rowCount; i++) {
                            pnum = $('#cpcontext').children().eq(i).children('td').eq(0).text();
                            if(pnum == cpnum) {
                                $('#cmsg').text("資料重複，請重新輸入。");
                                $('#dfCpNum').val('');
                                flag = false;
                            }
                        }

                        if(flag) {
                            $('#cpcontext').append("<tr><td style='text-align: center;' class='content_table_04_content'>" + data.paylst_num + "</td>" + td + data.title2  + "</td>" +
                                                    td + "<a id='" + $("input[id='StaNumD']").val() + ")' class='ajax append_mode delete' href='javascript: void(0);' desc=" + cpnum + "><img src='/GE/GE06/GE0601/Content/admin/images/sub_sys_delete_btn.gif' title='刪除' alt='刪除' border='0' /></a>" + "</tr>");
                            $('#cmsg').text('');
                        }
                    }
                });
            }
        });
        // 拷貝明細檔
        $('#CopyBtn').live('click', function () {
            //debugger;
            $.getValidationSummary().empty();
            
            var yy = $("#WorkYYDDLCOPY option:selected").val();
            var mm = $("#WorkMMDDLCOPY option:selected").val();

            var pNum, oNum, poNum;
            var lid = $("#lid").val();
            var msg="";

            // 新增主檔
            $.post('/GE/GE06/GE0601/Home/CopyM', null, function(data) {
                // 回傳清冊號
                pNum = data.substring(0,7);
                oNum = data.substring(7,data.length);

                // 計算行數
                rowCount = $('#cpcontext tr').length;
                for(var i = 0; i < rowCount; i++) {
                    poNum = $('#cpcontext').children().eq(i).children('td').eq(0).text();
                    // 新增拷貝檔
                    $.post('/GE/GE06/GE0601/Home/Copy', { pnum:pNum, ponum:poNum, yy:yy, mm:mm }, function(data) {});

                    //check 退休警示
                    $.post('/GE/GE06/GE0601/Home/chkCopyIsRet', { ponum:poNum }, function(data) {
                        if( data !="")
                        {
                          //msg = data +"『注意!!以上人員為本校退休人員，教育人員退休再任每月領取金額不得逾32160元，退休公務人員退休再任有給職務即應停發月退休金。請再次協助告知當事人，如有核發疑義，請洽詢人事室三組，分機63511』";
                          msg = data +"注意！！此人為本校退休人員，教育人員及公務人員退休再任每月領取金額超過法定基本工資者，應停發月退休金。請再次協助告知當事人，如有核發疑義，請洽詢人事室三組，分機63511"
                          //$("#msg2").text(msg);
                          alert(msg);
                        }
                    });
                }
                $('#cpcontext').html('');
                $('#SearchForm').show();
                $('#CopyMode,#CopyDialog').hide();

                $.getValidationSummary().html("複製完畢，清冊號為 "+ pNum + " ，流通文號為 " + oNum + "。");

            });
        });
    });

    function InitPPaylstNum() {
        $.post('/GE/GE06/GE0601/Home/ListPPaylstNum', null, function(data) {
            $('#dfPyNumDDL').empty();
            $('#dfPyNumDDL').append($('<option></option>').val('').text('請選擇'));
            $('#dfPyNumDDL').append(data);
        });
    };
    function InitCPaylstNum() {
        $.post('/GE/GE06/GE0601/Home/ListCPaylstNum', null, function(data) {
            $('#dfCpNumDDL').empty();
            $('#dfCpNumDDL').append($('<option></option>').val('').text('請選擇'));
            $('#dfCpNumDDL').append(data);
        });
    };
    function SimName() {
        //var type = $("#StaffCatalog3").val();
        var type = $("#StaffCatalog").val();
        var no = $("#StaNumE").val();

        if (type != 0 && no != "") {
            $.getJSON('/GE/GE06/GE0601/Home/GetIdentity', { type: type, no: no }, function(data) {
                // 設定姓名帳別-Simple
                if (data.Name != null && data.Account != null) {
                    $('#stmsg3').text('');
                    $('#NameE').val(data.Name);
                    $('#NameELbl').text(data.Name);
                    $('#AccountE').val(data.Account);
                    $('#AccountELbl').text(data.Account);
                } else if(data.Name != null && data.Account == null) {
                    $('#stmsg3').text(data.Msg);
                    $('#NameE').val(data.Name);
                    $('#NameELbl').text(data.Name);
                    $('#AccountE').val('');
                    $('#AccountELbl').text('');
                } else if(data.Name == null && data.Account == null) {
                    $('#stmsg3').text(data.Msg);
                    $('#StaNumE,#NameE,#AccountE').val('');
                    $('#NameELbl,#AccountELbl').text('');
                }

                if(type == '4' && data.Name != null) {
                    $('#StaNumE').val(data.StaNum);
                }
                ClearMoney();
            });

            //check 退休
            $.post('/GE/GE06/GE0601/Home/chkIsRet', { type: type, no: no }, function (data) {
                var arr = ["10201", "10202", "10203", "10204", "10205","10208","10210","10306"];//略過的款項類別
                var sal = $('select[name=SalCatalog3] :selected').val();
                if( data== true && arr.indexOf(sal)==-1 ) {
                    $('#stmsg_si').show();
                }
                else
                {
                    $('#stmsg_si').hide();
                }

            });

            //check 外籍
            $.post('/GE/GE06/GE0601/Home/chkIsFor', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog3] :selected').val();
                if( data== true) {
                    $('#stmsg_si2').show();
                }
                else
                {
                    $('#stmsg_si2').hide();
                }

            });
        }
    };
    function SalName() {
        var type = $("#StaffCatalog4").val();
        //debugger;
        //var type = $("#StaffCatalog").val();
        var no = $("#StaNumF").val();

        if (type != 0 && no != "") {
            $.getJSON('/GE/GE06/GE0601/Home/GetIdentity', { type: type, no: no }, function(data) {
                // 設定姓名帳別-Salary
                if (data.Name != null && data.Account != null) {
                    $('#stmsg4').text('');
                    $('#NameF').val(data.Name);
                    $('#NameFLbl').text(data.Name);
                    $('#AccountF').val(data.Account);
                    $('#AccountFLbl').text(data.Account);
                } else if(data.Name != null && data.Account == null) {
                    $('#stmsg4').text(data.Msg);
                    $('#NameF').val(data.Name);
                    $('#NameFLbl').text(data.Name);
                    $('#AccountF').val('');
                    $('#AccountFLbl').text('');
                } else if(data.Name == null && data.Account == null) {
                    $('#stmsg4').text(data.Msg);
                    $('#StaNumF,#NameF,#AccountF').val('');
                    $('#NameFLbl,#AccountFLbl').text('');
                }

                if(type == '4' && data.Name != null) {
                    $('#StaNumF').val(data.StaNum);
                }
                ClearMoney();
            });

            //check 退休
            $.post('/GE/GE06/GE0601/Home/chkIsRet', { type: type, no: no }, function (data) {
                var arr = ["10201", "10202", "10203", "10204", "10205","10208","10210","10306"];
                var sal = $('select[name=SalCatalog4] :selected').text().substr(0,5);
                if( data== true && arr.indexOf(sal)==-1 ) {
                    $('#stmsg_sa').show();
                }
                else
                {
                    $('#stmsg_sa').hide();
                }

            });

             //check 外籍
            $.post('/GE/GE06/GE0601/Home/chkIsFor', { type: type, no: no }, function (data) {
                var sal = $('select[name=SalCatalog4] :selected').text().substr(0,5);
                if( data== true) {
                    $('#stmsg_sa2').show();
                }
                else
                {
                    $('#stmsg_sa2').hide();
                }

            });
        }
    };
    function InitM() {
        // 主檔清空
        $(".addtionTxt").text('');
        // 新增資料列清空
        ClearCTR();
    };
    function ClearMsg() {
        $.getValidationSummary().empty();
         $("#msg2").text("");
    };
    // 清除抬頭
    function ClearTitle() {
        $("#Title1,#Title1D").val('國立政治大學' + 112 + '學年度第' + 2 + '學期');
        $("#Title2,#Title2D").val('');
    }
    // 新增明細檔後
    function ClearAll() {
        $("#SalTpe,#SalTpeD,#SalTpeE,#SalTpeF").val('');
        $("#salCG2  option:eq(0)").attr('selected',true);
        $("#salCG3  option:eq(0)").attr('selected',true);
        $("#salCG2E option:eq(0)").attr('selected',true);
        $("#salCG3E option:eq(0)").attr('selected',true);
        ClearSome();
    };
    // 新增明細檔後
    function ClearSome() {
        $("#StaNum,#StaNumD,#StaNumE,#StaNumF").val('');
        $("#stmsg1,#stmsg2,#stmsg3,#stmsg4,#satmsg,#satmsg2,#satmsg3,#satmsg4").text('');
        $("div[id='NameLbl'],       div[id='NameDLbl'],       div[id='NameELbl'],       div[id='NameFLbl']").text('');
        $("div[id='AccountLbl'],    div[id='AccountDLbl'],    div[id='AccountELbl'],    div[id='AccountFLbl']").text('');
        ClearMoney();
    };
    // 新增明細檔後
    function ClearMoney() {
        $("#UnitPrice,#UnitPriceD,#UnitPriceE,#UnitPriceF,#TotalAmount,#TotalAmountD,#TotalAmountE,#TotalAmountF,#Memo,#MemoD,#MemoE,#MemoF").val('');
        $("#Quantity,#QuantityD,#QuantityE,#QuantityF").val('1');
        $("#Tax,#TaxD,#TaxE,#TaxF,#FinFee2,#FinBoss2,#RetBossD,#InsBossD,#FinBossD,#FinBoss2D,#RetFeeD,#InsFeeD,#FinFeeD,#FinFee2D,#HelFeeD,#Other,#OtherD,#OtherE,#OtherF,#RetBossF,#InsBossF,#FinBossF,#FinBoss2F,#RetFeeF,#InsFeeF,#FinFeeF,#FinFee2F,#HelFeeF,#OtherF,#FinFee2E,#FinBoss2E").val('0');
        $("div[id='AmountLbl'],     div[id='AmountDLbl'],     div[id='AmountELbl'],     div[id='AmountFLbl']").text('');
        $("div[id='TotalAmountLbl'],div[id='TotalAmountDLbl'],div[id='TotalAmountELbl'],div[id='TotalAmountFLbl']").text('');
        $('.field-validation-error').empty();
        $('#newSimpleBtn2, #newSalaryBtn2').prop('disabled', true).removeClass( 'iput_btn').addClass('iput_btn_disabled');
    };
    // 檢查日期
    function Validate(str)
    {
        var re = /^(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$/;
        //var re = /^[0-9]{4}/(((0[13578]|(10|12))/(0[1-9]|[1-2][0-9]|3[0-1]))|(02/(0[1-9]|[1-2][0-9]))|((0[469]|11)/(0[1-9]|[1-2][0-9]|30)))$/;
        return re.test(str);
    }
    // 刪除明細檔
    function DelDetail(id) {
        $.post('/GE/GE06/GE0601/Home/DelDetail', { id:id }, function(data) { Calculator(); });
    }
    var simpleblurjumpflag2 = false;
    $(".simEGD").focusin(function () {
        $("#newSimpleBtn2").prop('disabled', true);
        $("#newSimpleBtn2").removeClass('iput_btn').addClass('iput_btn_disabled');
        simpleblurjumpflag2 = true;
    });
    $(".simEGD").focusout(function SimEGetDollar() {
        simpleblurjumpflag2 = false;
        var unit = 0, quan = 0, tax = 0, finfee2 = 0, other = 0, amount = 0;
        var staffcatalog = $("#StaffCatalog option:selected").text().substr(0, 1);
        var saltpe       = $("#SalTpeE").val().toString().substr(0, 5);
        var stanum       = $("#StaNumE").val();
        var yy;
        var mm;

        unit   = $("#UnitPriceE").val();
        quan   = $("#QuantityE").val()
        other  = $("#OtherE").val();
        amount = unit * quan;

        if(amount > 990000) {
            $("#AmountELbl").text('金額不得超過新台幣99萬元整').css('color','Red');
            amount = "";
        } else
            $("#AmountELbl").text(amount).number(true,0).css('color','Black');

        if(saltpe != "" && staffcatalog != "" && stanum != "" && amount != "") {
            var yy  = $("#WorkYYDDLS").val();
            var mm  = $("#WorkMMDDLS").val();
            debugger;
            $.post('/GE/GE06/GE0601/Home/GetFin2', { tax: tax, saltpe: saltpe, pkd: staffcatalog, stanum: stanum, yy: yy, mm: mm , key:"0", amt: amount}, function(data) {
                //debugger;
                tax = data.Tax;
                finfee2 = data.Fin2;
                var isFacReli = data.IsFacReli;
                var reliOv = data.ReliOv;
                var reliOvMsg = data.ReliOvMsg;
                var exmOv = data.ExmOv;
                var exmOvMsg = data.ExmOvMsg;

//                if(reliOv || exmOv)
//                {
//                    if(reliOv)
//                    {
//                        $("#AmountELbl").text(reliOvMsg).css('color','Red');
//                    }
//                    if(exmOv)
//                    {
//                        $("#AmountELbl").text(exmOvMsg).css('color','Red');
//                    }
//                    tax = $("#TaxE").val();
//                    finfee2 = $("#FinFee2E").val();
//                    $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0);
//                    $("#TotalAmountE").val(amount - tax - finfee2 - other);
//                }
//                else
//                {
                    $("#TaxE").val(tax);
                    $("#FinFee2E").val(finfee2);
                    $("#FinBoss2E").val(data.Fin2Boss);
                    $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0);
                    $("#TotalAmountE").val(amount - tax - finfee2 - other);

                    if(!simpleblurjumpflag2){
                        $("#newSimpleBtn2").removeClass( 'iput_btn_disabled').addClass('iput_btn');
                        $("#newSimpleBtn2").prop('disabled', false);
                    }
//                }
            });
        } else { // 單價、數量輸入但其他值==""時
            tax = $("#TaxE").val();
            finfee2 = $("#FinFee2E").val();
            $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0);
            $("#TotalAmountE").val(amount - tax - finfee2 - other);
        }
    });
    // 稅、二代健保自動計算後想自行輸入時
    function SimECalDollar() {
        var amount = $("#UnitPriceE").val() * $("#QuantityE").val();
        var tax = $("#TaxE").val();
        var finfee2 = $("#FinFee2E").val();
        var other = $("#OtherE").val();

        if(amount - tax - finfee2 - other >= 0)
            $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0);
        else {
            var pos = "-";
            var num = $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0).text();
            $("#TotalAmountELbl").text(pos + num);
        }
        $("#TotalAmountE").val(amount - tax - finfee2 - other);
    };
    var salblurjumpflag2 = false;
    $(".salEGD").focusin(function () {
        $("#newSalaryBtn2").prop('disabled', true);
        $("#newSalaryBtn2").removeClass('iput_btn').addClass('iput_btn_disabled');
        salblurjumpflag2 = true;
    })
    $(".salEGD").focusout(function SalEGetDollar() {
        salblurjumpflag2 = false;
        var tax = 0, finfee2 = 0;
        var staffcatalog = $("#StaffCatalog option:selected").text().substr(0, 1);
        var saltpe       = $("#SalTpeF").val().toString().substr(0, 5);
        var stanum       = $("#StaNumF").val();
        var amount       = $("#UnitPriceF").val() * $("#QuantityF").val();

        if(amount > 990000) {
            $("#AmountFLbl").text('金額不得超過新台幣99萬元整').css('color','Red');
            amount = "";
        } else
            $("#AmountFLbl").text(amount).number(true,0).css('color','Black');

        if(saltpe != "" && staffcatalog != "" && stanum != "" && amount != "") {
            var yy   = $("#WorkYYDDLS").val();
            var mm   = $("#WorkMMDDLS").val();
            debugger;
            $.post('/GE/GE06/GE0601/Home/GetFin2', { tax: tax, saltpe: saltpe, pkd: staffcatalog, stanum: stanum, yy: yy, mm: mm , key:"0", amt: amount}, function(data) {
                //debugger;
                tax = data.Tax;
                finfee2 = data.Fin2;
                var isFacReli = data.IsFacReli;
                var reliOv = data.ReliOv;
                var reliOvMsg = data.ReliOvMsg;
                var exmOv = data.ExmOv;
                var exmOvMsg = data.ExmOvMsg;

//                if(reliOv || exmOv)
//                {
//                    if(reliOv)
//                    {
//                        $("#AmountFLbl").text(reliOvMsg).css('color','Red');
//                    }
//                    if(exmOv)
//                    {
//                        $("#AmountFLbl").text(exmOvMsg).css('color','Red');
//                    }
//                    tax = $("#TaxE").val();
//                    finfee2 = $("#FinFee2E").val();
//                    $("#TotalAmountELbl").text(amount - tax - finfee2 - other).number(true,0);
//                    $("#TotalAmountE").val(amount - tax - finfee2 - other);
//                }
//                else
//                {
                    $("#TaxF").val(tax);
                    $("#FinFee2F").val(finfee2);
                    $("#FinBoss2F").val(data.Fin2Boss);
                    $("#TotalAmountFLbl").text(amount - tax - finfee2 - $("#RetFeeF").val() - $("#InsFeeF").val()- $("#FinFeeF").val() - $("#HelFeeF").val() - $("#OtherF").val()).number(true,0);
                    $("#TotalAmountF").val(amount - tax - finfee2 - $("#RetFeeF").val() - $("#InsFeeF").val()- $("#FinFeeF").val() - $("#HelFeeF").val() - $("#OtherF").val());
                    if(!salblurjumpflag2){
                        $("#newSalaryBtn2").removeClass( 'iput_btn_disabled').addClass('iput_btn');
                        $("#newSalaryBtn2").prop('disabled', false);
                    }
//                }
            });
        } else {
            tax = $("#TaxF").val();
            finfee2 = $("#FinFee2F").val();
            $("#TotalAmountFLbl").text(amount - tax - finfee2 - $("#RetFeeF").val() - $("#InsFeeF").val()- $("#FinFeeF").val() - $("#HelFeeF").val() - $("#OtherF").val()).number(true,0);
            $("#TotalAmountF").val(amount - tax - finfee2 - $("#RetFeeF").val() - $("#InsFeeF").val()- $("#FinFeeF").val() - $("#HelFeeF").val() - $("#OtherF").val());
        }
    });
    // 稅、二代健保自動計算後想自行輸入時
    function SalECalDollar() {
        var amount  = $("#UnitPriceF").val() * $("#QuantityF").val();
        var tax     = $("#TaxF").val();
        var insfee  = $("#InsFeeF").val();
        var finfee  = $("#FinFeeF").val();
        var finfee2 = $("#FinFee2F").val();
        var retfee  = $("#RetFeeF").val();
        var helfee  = $("#HelFeeF").val();
        var other   = $("#OtherF").val();

        if(amount - tax - insfee - finfee - finfee2 - retfee - helfee - other >= 0)
            $("#TotalAmountFLbl").text(amount - tax - insfee - finfee - finfee2 - retfee - helfee - other).number(true,0);
        else {
            var pos = "-";
            var num = $("#TotalAmountFLbl").text(amount - tax - insfee - finfee - finfee2 - retfee - helfee - other).number(true,0).text();
            $("#TotalAmountFLbl").text(pos + num);
        }

        $("#TotalAmountF").val(amount - tax - insfee - finfee - finfee2 - retfee - helfee - other);
    };
    //
    function Saving(obj) {
        temp = $(obj).val();
        $('#updateMsg').text("儲存中...");
    }
    // 判斷輸入金額是否為整數
    function isInt(i) { return ((i % 1) == 0)? i : false; };
    // 判斷輸入金額是否為整數
    function isNum(i) { return ((i % 1) == 0) ? true : false; };
    // 計算金額-Edit
    function EditGetDollar(obj,type) {
        //debugger;
        if(isInt(temp) && type==1) {
            // 非整數
            if(!isInt($(obj).val())) {
                $('#updateMsg').text("金額格式錯誤");
                $(obj).val(temp);
                return false;
            }
            // 第1數字為0
            if($(obj).val().length >=2 && $(obj).val().substring(0,1) == 0) {
                $('#updateMsg').text("金額格式錯誤");
                $(obj).val(temp);
                return false;
            }
            // 負數
            if($(obj).val() < 0) {
                $('#updateMsg').text("不得為負數");
                $(obj).val(temp);
                return false;
            }
        } 
        else
        { // 備註
            if($(obj).val().length > 30) {
                $('#updateMsg').text("備註字數不得大於30");
                $(obj).val(temp);
                return false;
            }
        }
       
           


        key = $(obj).parent().parent().attr("key");

        midd  = $("#fixedTableEdit tr[key=" + key + "]").children('td');
        left  = $(".DTFC_LeftBodyWrapper  tr[key=" + key + "]").children('td');
        right = $(".DTFC_RightBodyWrapper tr[key=" + key + "]").children('td');

        debugger;
        var tax = 0, amount = 0;

        var ipk     = key;
        var tpe    = left.eq(0).text();
        var stanum = left.eq(2).text().trim();
        //var yy = left.eq(4).text().trim();
        var yy = left.eq(4).children().val()
        //var mm = left.eq(5).text().trim();
        var mm = left.eq(5).children().val().trim();
        if(mm.length == 1)
        {
            mm = "0"+mm;
            left.eq(5).children().val(mm);
        }
        var saltpe = left.eq(6).children().text().trim();
        var unit    = left.eq(7).children().val();
        var quan    = midd.eq(0).children().val();

        tax     = midd.eq(2).children().val();
        var insf    = midd.eq(3).children().val();
        var insb    = midd.eq(4).children().val();
        var finf    = midd.eq(5).children().val();
        var finb    = midd.eq(6).children().val();
        var finf2   = midd.eq(7).children().val();
        var finb2   = midd.eq(8).children().val();
        var retf    = midd.eq(9).children().val();
        var retb    = midd.eq(10).children().val();
        var helf    = midd.eq(11).children().val();
        var other   = midd.eq(12).children().val();
        var memo    = midd.eq(13).children().val();

        var dollar  = unit * quan;
        var total = unit * quan - tax - retf - insf - finf - finf2 - helf - other;

        // 實發金額負數
        if(total < 0) {
            $('#updateMsg').text("實發金額不得為負數");
            $(obj).val(temp);
            return false;
        }

        if($.trim(tpe) == "職")
            pkd = "1";
        else if($.trim(tpe) == "學")
            pkd = "2";
        else
            pkd = "4";

        // 更新明細檔
        debugger;
        $.post('/GE/GE06/GE0601/Home/GetFin2', { tax: tax, saltpe: saltpe, pkd: pkd, stanum: stanum, yy:yy , mm:mm, key:key, amt: dollar }, function(data) {
            debugger;
            //tax = data.Tax;
            //finfee2 = data.Fin2;
            //finboss2 = data.Fin2Boss;

            //midd.eq(2).children().val(tax);
            //midd.eq(7).children().val(finfee2);
            //midd.eq(8).children().val(finboss2);
            //midd.eq(14).text(data.Msg);

            total = dollar - tax - retf - insf - finf - finf2 - helf - other;
            $.post('/GE/GE06/GE0601/Home/Update', { ipk:ipk, unitprice:unit, amount:quan, dollar:dollar, tax:tax,
                                              insfee:insf, insboss:insb, finfee:finf, finboss:finb, finfee2:finf2, finboss2:finb2, retfee:retf, retboss:retb, helfee:helf,
                                              other:other, income:total, memo:memo,yy:yy, mm:mm }, function(data) {
                                                  debugger;
                                                  if(data) {
                                                      debugger;
                                                      //left.eq(7).children().val(dollar)
                                                      //left.eq(7).text(dollar).number(true,0);
                                                      midd.eq(1).text(dollar).number(true,0);
                                                      right.eq(0).text(total).number(true,0);
                                                      $('#updateMsg').text("已儲存所有變更");
                                                      // 合計
                                                      Calculator();
                                                  }
                                              });
        });
    }
    // 計算稅、二代健保金額-Edit
    function EditCalDollar(obj,type) {
        if(type == 3)
        {
            //年
            var today = new Date();
            var intyy = parseFloat(today.getFullYear())

            var i = parseFloat($(obj).val());
            if (i <= 0 || i > 9999) { /*年*/
              $('#updateMsg').text("年分輸入錯誤");
                $(obj).val(temp);
                return false;
            }
            if(i != intyy && i != intyy+1 && i != intyy-1)
            {
                $('#updateMsg').text("年分輸入錯誤-今年、去年或明年");
                $(obj).val(temp);
                return false;
            }
        }
        else if(type == 4)
        {
            //月
             var i= parseFloat($(obj).val());
            if (i <= 0 || i > 12) { /*月*/
              $('#updateMsg').text("月份輸入錯誤1-12");
                $(obj).val(temp);
                return false;
            }
        }
        else
        {
            if(isInt(temp)) {
                // 非整數
                if(!isInt($(obj).val())) {
                    $('#updateMsg').text("金額格式錯誤");
                    $(obj).val(temp);
                    return false;
                }
                // 第1數字為0
                if($(obj).val().length >=2 && $(obj).val().substring(0,1) == 0) {
                    $('#updateMsg').text("金額格式錯誤");
                    $(obj).val(temp);
                    return false;
                }
                // 負數
                if($(obj).val() < 0) {
                    $('#updateMsg').text("不得為負數");
                    $(obj).val(temp);
                    return false;
                }
            } else { // 備註
                if($(obj).val().length > 30) {
                    $('#updateMsg').text("備註字數不得大於30");
                    $(obj).val(temp);
                    return false;
                }
            }
        }
        //debugger;
        key = $(obj).parent().parent().attr("key");

        midd  = $("#fixedTableEdit tr[key=" + key + "]").children('td');
        left  = $(".DTFC_LeftBodyWrapper  tr[key=" + key + "]").children('td');
        right = $(".DTFC_RightBodyWrapper tr[key=" + key + "]").children('td');

        var tax = 0, amount = 0;

        var ipk    = key;
        var tpe    = left.eq(0).text();
        var stanum = left.eq(2).text().trim();

        //var yy = left.eq(4).text().trim();
        var yy = left.eq(4).children().val()
        //var mm = left.eq(5).text().trim();
        var mm = left.eq(5).children().val().trim();
        if(mm.length == 1)
        {
            mm = "0"+mm;
            left.eq(5).children().val(mm);
        }
        var saltpe = left.eq(6).children().text().trim();
        var unit   = left.eq(7).children().val();
        var quan   = midd.eq(0).children().val();

        var insf   = midd.eq(3).children().val();
        var insb   = midd.eq(4).children().val();
        var finf   = midd.eq(5).children().val();
        var finb   = midd.eq(6).children().val();
        var finf2  = midd.eq(7).children().val();
        var finb2  = midd.eq(8).children().val();
        var retf   = midd.eq(9).children().val();
        var retb   = midd.eq(10).children().val();
        var helf   = midd.eq(11).children().val();
        var other  = midd.eq(12).children().val();
        var memo   = midd.eq(13).children().val();

        var dollar = unit * quan;
        var total = dollar - tax - retf - insf - finf - finf2 - helf - other;

        // 實發金額負數
        if(total < 0) {
            $('#updateMsg').text("實發金額不得為負數");
            $(obj).val(temp);
            return false;
        }
        // >990000
        if(dollar > 990000) {
            $('#updateMsg').text("每筆匯款不得超過新台幣99萬元整");
            $(obj).val(temp);
            return false;
        }

        if($.trim(tpe) == "職")
            pkd = "1";
        else if($.trim(tpe) == "學")
            pkd = "2";
        else
            pkd = "4";
         debugger;
        $.post('/GE/GE06/GE0601/Home/GetFin2', { tax: tax, saltpe: saltpe, pkd: pkd, stanum: stanum, yy:yy, mm:mm, key:key, amt: dollar }, function(data) {
            debugger;
            tax = data.Tax;
            finfee2 = data.Fin2;
            finboss2 = data.Fin2Boss;

            midd.eq(2).children().val(tax);
            midd.eq(7).children().val(finfee2);
            midd.eq(8).children().val(finboss2);
            midd.eq(14).text(data.Msg);

            total = dollar - tax - retf - insf - finf - finfee2 - helf - other;

            // 更新明細檔
            $.post('/GE/GE06/GE0601/Home/Update', { ipk:ipk, unitprice:unit, amount:quan, dollar:dollar, tax:tax,
                                              insfee:insf, insboss:insb, finfee:finf, finboss:finb, finfee2:finfee2, finboss2:finboss2, retfee:retf, retboss:retb, helfee:helf,
                                              other:other, income:total, memo:memo,yy:yy, mm:mm }, function(data) {
                                                  if(data) {
                                                      $('#updateMsg').text("已儲存所有變更");
                                                      midd.eq(1).text(dollar).number(true,0);
                                                      right.eq(0).text(total).number(true,0);
                                                      // 合計
                                                      Calculator();
                                                  }
                                              });
        });
    }
    // 合計
    function Calculator()
    {
        //debugger;
        // 取得清冊號
        var pn = $("#pnumeditlblL").text();
        // 各欄位合計
        $.post('/GE/GE06/GE0601/Home/GetTotal', { pn: pn, type: "none" }, function(data) {
            $(".DTFC_LeftBodyWrapper tr.totalTR").children('td').eq(7).text("");

            $("#fixedTableEdit tr.totalTR").children('td').eq(0).text(data.Amount2);
            $("#fixedTableEdit tr.totalTR").children('td').eq(1).text(data.Amount);
            $("#fixedTableEdit tr.totalTR").children('td').eq(2).text(data.Tax);
            $("#fixedTableEdit tr.totalTR").children('td').eq(3).text(data.InsFee);
            $("#fixedTableEdit tr.totalTR").children('td').eq(4).text(data.InsBoss);
            $("#fixedTableEdit tr.totalTR").children('td').eq(5).text(data.FinFee);
            $("#fixedTableEdit tr.totalTR").children('td').eq(6).text(data.FinBoss);
            $("#fixedTableEdit tr.totalTR").children('td').eq(7).text(data.FinFee2);
            $("#fixedTableEdit tr.totalTR").children('td').eq(8).text(data.FinBoss2);
            $("#fixedTableEdit tr.totalTR").children('td').eq(9).text(data.RetFee);
            $("#fixedTableEdit tr.totalTR").children('td').eq(10).text(data.RetBoss);
            $("#fixedTableEdit tr.totalTR").children('td').eq(11).text(data.HelFee);
            $("#fixedTableEdit tr.totalTR").children('td').eq(12).text(data.Other);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(0).text(data.Tax);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(1).text(data.InsFee);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(2).text(data.InsBoss);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(3).text(data.FinFee);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(4).text(data.FinBoss);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(5).text(data.FinFee2);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(6).text(data.FinBoss2);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(7).text(data.RetFee);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(8).text(data.RetBoss);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(9).text(data.HelFee);
            //$("#fixedTableEdit tr.totalTR").children('td').eq(10).text(data.Other);

            $(".DTFC_RightBodyWrapper tr.totalTR").children('td').eq(0).text(data.TotalAmount);
        });
    }
    // Check Simple New
    function CheckSimpleNew()
    {
        var errormsg1 = "學生之工讀金請至「行政資訊系統下之工讀金造冊系統」維護";
        var errormsg2 = "學生之獎學金請至「單位管理系統之獎學金造冊系統」維護";

        var staffcatalog = $("#StaffCatalog option:selected").text().substring(0, 1);
        var saltpe = $("input[id='SalTpeE']").val().substring(0,3);

        if (staffcatalog == "2" && saltpe == "201") {
            $("#satmsg3").text(errormsg1);
            return false;
        }
        else if(staffcatalog == "2" && saltpe == "202")
        {
            $("#satmsg3").text(errormsg2);
            return false;
        }
        else {

            return true;
        }
    };
    // Check Salary New
    function CheckSalaryNew()
    {
        var errormsg1 = "學生之工讀金請至「行政資訊系統下之工讀金造冊系統」維護";
        var errormsg2 = "學生之獎學金請至「單位管理系統之獎學金造冊系統」維護";

        var staffcatalog = $("#StaffCatalog option:selected").text().substring(0, 1);
        var saltpe = $("input[id='SalTpeF']").val().substring(0,3);
        var saltpeall =$("input[id='SalTpeF']").val().substring(0,5);

        if (staffcatalog == "2" && saltpe == "201" && saltpeall != "20108") {
            $("#satmsg4").text(errormsg1);
            return false;
        }
        else if(staffcatalog == "2" && saltpe == "202")
        {
            $("#satmsg4").text(errormsg2);
            return false;
        }
        else {
            return true;
        }
    };
    // 防止按enter即送出
    function disableEnterKey(e)
    {
        var key;
        if(window.event)
            key = window.event.keyCode; //IE
        else
            key = e.which; //FireFox
        return (key != 13);
    };
    // 解決IE8按enter即送出
    function stopRKey(evt) {
        evt = (evt) ? evt : ((event) ? event : null);
        var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
        if ((evt.keyCode == 13) ) {return false;}
     }

    $(function () {
        // 支領年
        $('#WorkYYDDLCOPY').change(function () {
            $('#WorkYMCOPY').val($("#WorkYYDDLCOPY option:selected").val() + $("#WorkMMDDLCOPY option:selected").val());
        });
        // 支領月
        $('#WorkMMDDLS').change(function () {
            $('#WorkYMCOPY').val($("#WorkYYDDLCOPY option:selected").val() + $("#WorkMMDDLCOPY option:selected").val());
        });
    });

</script>

                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
    <div id="footer">
        <hr width="96%" size="1" />
        <p>
            本系統業管單位係總務處出納組，如有任何問題，請參閱<a href="https://schwebap.nccu.edu.tw/nccumisdoc/FAQ/GE0601.pdf" target="_blank">使用說明</a>或電洽出納組相關同仁<br />
            Copyright © 2013 National Chengchi University. All Rights Reserved.<br />
            如對系統有任何問題，請電(02)29387599（校外直撥）或 校內分機：67599
        </p>
    </div>
    <!-- 預設要放置進度條的 div ，預設為 display: none -->
    <div id="progressbar" style="height:20px; display:none;" ></div>
</body>
</html>

<script type="text/javascript">
    $(document).ajaxError(function (event, xhr, settings) {
        if (xhr.status == 403) {
            alert("網路連線逾時，請重新登入!");
            window.location = "https://webapp.nccu.edu.tw/SSO/Logout.aspx";
        }
    });
</script>